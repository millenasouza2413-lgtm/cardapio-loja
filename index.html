<!doctype html>
<html lang="pt-BR">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1, maximum-scale=5.0, user-scalable=yes" />
<title>Doce Confete ‚Äî Card√°pio</title>
<style>
:root{
  --brown:#6b3b1a; --brown-dark:#4d2c15; --orange:#ff6a00; --pastel:#fff6b8;
  --card:#fff; --muted:#6b6b6b; --radius:12px; --shadow:0 10px 30px rgba(0,0,0,0.08);
  --max-card-width:420px;
  --page-padding:14px;
  --success:#27ae60; --warning:#f39c12; --error:#e74c3c;
}

/* Reset / base */
*{box-sizing:border-box}
html,body{height:100%}
body{
  margin:0;
  font-family:Poppins, system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
  background:var(--pastel);
  -webkit-print-color-adjust:exact;
  print-color-adjust:exact;
  padding-bottom:120px;
  font-size:16px;
  line-height:1.5;
}
header{background:var(--brown);color:#fff;padding:16px;display:flex;align-items:center;gap:12px;justify-content:center;text-align:center;}
.logo{width:72px;height:72px;border-radius:10px;overflow:hidden;background:#fff3d6;display:flex;align-items:center;justify-content:center;flex-shrink:0}
.logo img{width:100%;height:100%;object-fit:contain}
.title h1{margin:0;font-size:22px;color:#fff;font-weight:800}
.title p{margin:4px 0 0 0;font-size:13px;color:#ffeaa7}
.banner{background:#fffae5;color:#b36b00;text-align:center;font-weight:700;padding:12px;border-bottom:2px solid #ffc46b;font-size:16px;}
.delivery-note{background:#fff3d6;padding:12px;text-align:center;color:#7a4a00;font-weight:800;border-bottom:1px dashed rgba(0,0,0,0.04);font-size:15px;}
main{
  max-width:1100px;
  margin:18px auto;
  padding:var(--page-padding);
  display:grid;
  grid-template-columns:1fr 380px;
  gap:18px;
  align-items:start;
}

/* Instru√ß√µes destacadas */
.instructions-box {
  background: #fff;
  border-radius: var(--radius);
  padding: 16px;
  margin: 16px 0;
  border-left: 4px solid var(--orange);
  box-shadow: var(--shadow);
}
.instructions-box h3 {
  margin-top: 0;
  color: var(--brown-dark);
  display: flex;
  align-items: center;
  gap: 8px;
}
.instructions-box h3::before {
  content: "üìå";
  font-size: 18px;
}

/* Alertas */
.alert {
  padding: 12px 16px;
  border-radius: var(--radius);
  margin: 12px 0;
  font-weight: 600;
  display: flex;
  align-items: center;
  gap: 10px;
}
.alert-warning {
  background: #fff3cd;
  border: 2px solid #ffc107;
  color: #856404;
}
.alert-info {
  background: #d1ecf1;
  border: 2px solid #0dcaf0;
  color: #0c5460;
}

/* STEP INDICATOR */
.steps{background:transparent;padding:10px 0 6px 0;margin-bottom:6px;text-align:center}
.step-list{display:inline-flex;gap:10px;align-items:center;flex-wrap:wrap;justify-content:center}
.step{background:#fff;padding:8px 12px;border-radius:999px;border:1px solid rgba(0,0,0,0.06);font-weight:700}
.step.active{background:var(--brown);color:#fff;border-color:transparent}

/* Produtos layout */
.produtos{
  display:grid;
  grid-template-columns:repeat(auto-fill,minmax(280px,1fr));
  gap:14px;
  justify-items:center;
  padding:6px 0;
}

/* Card padr√£o (centralizado e responsivo) */
.card{
  background:var(--card);
  border-radius:var(--radius);
  padding:16px;
  box-shadow:var(--shadow);
  display:flex;
  flex-direction:column;
  gap:12px;
  min-height:240px;
  position:relative;
  overflow:hidden;
  width:100%;
  max-width:var(--max-card-width);
  margin:0 auto 18px;
  border: 2px solid transparent;
  transition: all 0.3s ease;
}
.card:hover {
  border-color: var(--orange);
  transform: translateY(-4px);
}
.card-highlight {
  border: 2px solid var(--orange) !important;
  background: #fffaf0;
}

/* Imagem do card */
.thumb{
  height:220px;
  border-radius:10px;
  overflow:hidden;
  display:flex;
  align-items:center;
  justify-content:center;
  background:#f6f6f6;
  position:relative;
}
.thumb img{
  width:100%;
  height:100%;
  object-fit:cover;
  object-position:center;
  display:block;
  transition:transform .28s ease,filter .28s ease;
}
.thumb:hover img{transform:scale(1.03);filter:brightness(1.03)}

/* Promo badge */
.promo-badge{
  position:absolute;top:12px;left:12px;
  background:linear-gradient(90deg,#ff3b30,#ffb347);
  color:#fff;font-weight:900;padding:8px 12px;border-radius:999px;
  font-size:13px;box-shadow:0 8px 22px rgba(255,59,48,0.18);
  transform:rotate(-8deg);display:inline-block;z-index:5;text-transform:uppercase;letter-spacing:0.6px;
  animation:promo-pulse 1600ms infinite;
}
@keyframes promo-pulse{0%{transform:rotate(-8deg) scale(1)}50%{transform:rotate(-8deg) scale(1.04)}100%{transform:rotate(-8deg) scale(1)}}

/* Info / pre√ßo / nome */
.info{display:flex;justify-content:space-between;align-items:center;gap:8px;flex-wrap:wrap}
.nome{font-weight:800;font-size:17px;color:var(--orange)}
.preco{color:var(--brown-dark);font-weight:900;font-size:18px}
.preco-old{color:#999;text-decoration:line-through;font-size:14px}

/* Controles (quantidade + adicionar) */
.controle{display:flex;align-items:center;gap:12px;justify-content:space-between;margin-top:auto;width:100%}
.qty{display:flex;align-items:center;gap:8px;background:#fff4e6;padding:8px;border-radius:10px;font-weight:800;border:1px solid rgba(0,0,0,0.04)}
.qty button{background:transparent;border:none;font-size:22px;width:44px;height:44px;cursor:pointer;color:var(--brown-dark);border-radius:8px;}
.qty button:hover{background:rgba(0,0,0,0.05)}
.qty .n{min-width:44px;text-align:center;font-size:18px;}
.add-btn{background:var(--brown);color:#fff;border:none;padding:14px 20px;border-radius:12px;cursor:pointer;font-weight:900;box-shadow:0 6px 12px rgba(0,0,0,0.1);font-size:16px;flex:1;transition:all 0.2s ease;}
.add-btn:hover{filter:brightness(.96);transform:translateY(-2px);box-shadow:0 8px 16px rgba(0,0,0,0.15)}
.add-btn:active{transform:translateY(0)}
.add-btn.disabled{background:#ccc;cursor:not-allowed;transform:none !important;box-shadow:none !important;}

/* Seletores de quantidade melhorados */
.qty-selector {
  display: flex;
  gap: 6px;
  align-items: center;
  margin-top: 8px;
}
.qty-selector select {
  padding: 10px 14px;
  border-radius: 8px;
  border: 1px solid #ddd;
  font-size: 16px;
  background: white;
  flex: 1;
}

/* SABORES - AGORA VIS√çVEIS JUNTO COM OS KITS */
.kit-sabores-container {
  background: #fff;
  border-radius: var(--radius);
  padding: 18px;
  margin: 16px 0;
  box-shadow: var(--shadow);
  border: 2px solid #ffc46b;
  animation: fadeIn 0.5s ease;
}
@keyframes fadeIn {
  from { opacity: 0; transform: translateY(10px); }
  to { opacity: 1; transform: translateY(0); }
}
.kit-sabores-header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  margin-bottom: 16px;
}
.kit-sabores-header h3 {
  margin: 0;
  color: var(--brown-dark);
  font-size: 18px;
}
.sabores-section {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 20px;
  margin-bottom: 16px;
}
@media (max-width: 768px) {
  .sabores-section {
    grid-template-columns: 1fr;
  }
}
.sabor-group {
  background: #f9f9f9;
  padding: 16px;
  border-radius: 8px;
}
.sabor-group h4 {
  margin-top: 0;
  color: var(--brown);
  font-size: 16px;
  display: flex;
  align-items: center;
  gap: 8px;
  margin-bottom: 12px;
}
.sabor-group h4::before {
  content: "üëá";
}
.sabor-list{
  display:flex;
  flex-wrap:wrap;
  gap:8px;
}
.sabor-item{
  background:#fff;
  padding:10px 14px;
  border-radius:12px;
  border:2px solid #f0e6d9;
  cursor:pointer;
  display:inline-flex;
  align-items:center;
  gap:8px;
  font-size:15px;
  transition:all 0.2s ease;
}
.sabor-item:hover {
  border-color: var(--orange);
  background: #fffaf0;
}
.sabor-item.selected {
  background: var(--pastel);
  border-color: var(--orange);
  font-weight: 600;
}
.sabor-item input{
  margin:0;
  width:18px;
  height:18px;
}
.sabor-todos{
  display:flex;
  align-items:center;
  gap:10px;
  margin-bottom:12px;
  padding:10px;
  background:#fffbe6;
  border-radius:8px;
}
.sabor-todos label {
  display: flex;
  align-items: center;
  gap: 10px;
  font-weight: 600;
  cursor: pointer;
}

/* Carrinho lateral */
#carrinho{
  position:sticky;
  top:18px;
  background:var(--card);
  padding:18px;
  border-radius:var(--radius);
  box-shadow:var(--shadow);
  height:fit-content;
  border: 2px solid var(--brown);
}
#lista-carrinho{
  list-style:none;
  margin:0;
  padding:0;
  max-height:380px;
  overflow:auto;
}
#lista-carrinho li{
  display:flex;
  gap:10px;
  padding:12px 0;
  border-bottom:2px dashed #f0f0f0;
  align-items:center;
}
.mini-thumb{
  width:64px;
  height:48px;
  border-radius:8px;
  overflow:hidden;
  background:#f3f3f3;
  flex-shrink:0;
}
.mini-thumb img{
  width:100%;
  height:100%;
  object-fit:cover;
  display:block;
}
.cart-meta{
  flex:1;
  font-size:14px;
}
.cart-meta .cname{
  font-weight:800;
  color:var(--orange);
  font-size:15px;
}
.cart-meta .csub{
  color:var(--muted);
  font-size:13px;
  margin-top:4px;
}
.cart-right{
  text-align:right;
  display:flex;
  flex-direction:column;
  gap:4px;
}
.cart-right .subtotal{
  font-weight:900;
  color:var(--brown-dark);
  font-size:15px;
}
.cart-right .remove{
  font-size:12px;
  color:#e74c3c;
  cursor:pointer;
  text-decoration:underline;
}
#total{
  font-weight:900;
  text-align:right;
  font-size:20px;
  margin-top:14px;
  color:var(--brown-dark);
  padding-top:12px;
  border-top:2px solid #eee;
}
#whatsapp-btn{
  display:block;
  text-align:center;
  background:var(--brown-dark);
  color:var(--pastel,#fff);
  text-decoration:none;
  padding:16px 10px;
  border-radius:12px;
  margin-top:16px;
  font-weight:900;
  font-size:17px;
  transition:all 0.2s ease;
}
#whatsapp-btn:hover{
  background:var(--brown);
  transform:translateY(-2px);
  box-shadow:0 8px 16px rgba(0,0,0,0.15);
}

/* COMBOS */
.combos{
  margin-top:18px;
  background:var(--card);
  padding:18px;
  border-radius:var(--radius);
  box-shadow:var(--shadow);
}
.combos-grid{
  display:grid;
  grid-template-columns:repeat(auto-fill,minmax(260px,1fr));
  gap:16px;
  margin-top:12px;
  justify-items:center;
}
.combo-card{
  background:var(--card);
  border-radius:12px;
  padding:14px;
  box-shadow:var(--shadow);
  display:flex;
  flex-direction:column;
  gap:12px;
  min-height:200px;
  width:100%;
  max-width:var(--max-card-width);
  margin:0 auto;
  border: 2px solid transparent;
  transition: all 0.3s ease;
}
.combo-card:hover {
  border-color: var(--orange);
}
.combo-card .thumb{
  height:180px;
}
.kits-grid{
  display:grid;
  grid-template-columns:repeat(auto-fill,minmax(260px,1fr));
  gap:16px;
  margin-top:16px;
  justify-items:center;
}

.page-break{page-break-before:always;break-before:page;-webkit-break-before:always}

/* FAB (bot√£o flutuante) */
.fab{
  position:fixed;
  right:20px;
  bottom:20px;
  z-index:1200;
  background:var(--brown);
  width:70px;
  height:70px;
  border-radius:20px;
  display:flex;
  align-items:center;
  justify-content:center;
  box-shadow:0 12px 30px rgba(0,0,0,0.25);
  cursor:pointer;
  color:#fff;
  transition:all 0.3s ease;
}
.fab:hover{
  transform:scale(1.1);
  box-shadow:0 16px 40px rgba(0,0,0,0.3);
}
.fab .badge{
  position:absolute;
  top:-8px;
  right:-8px;
  background:var(--orange);
  color:#fff;
  width:28px;
  height:28px;
  border-radius:14px;
  display:flex;
  align-items:center;
  justify-content:center;
  font-weight:900;
  font-size:14px;
  border:2px solid white;
}
.toast{
  position:fixed;
  left:50%;
  transform:translateX(-50%);
  bottom:110px;
  background:#222;
  color:#fff;
  padding:12px 18px;
  border-radius:12px;
  opacity:0;
  pointer-events:none;
  transition:.3s;
  z-index:9999;
  font-weight:600;
  box-shadow:0 8px 20px rgba(0,0,0,0.2);
}
.toast.show{
  opacity:1;
  pointer-events:auto;
}

/* mobile improvements */
@media (max-width:980px){
  main{
    grid-template-columns:1fr;
    padding:12px;
  }
  #carrinho{
    position:relative;
    top:auto;
    margin-top:16px;
    order: 999;
  }
  .fab{
    right:16px;
    bottom:16px;
  }
}

/* MELHORIAS PARA CELULAR - TUDO MAIOR E MAIS F√ÅCIL */
@media (max-width:600px){
  :root{ 
    --max-card-width:100%;
    --page-padding:12px;
  }
  
  body {
    font-size: 17px;
  }
  
  /* Header otimizado */
  header {
    flex-direction: row;
    padding: 14px 12px;
    gap: 12px;
    text-align: left;
  }
  .logo {
    width: 60px;
    height: 60px;
  }
  .title h1 {
    font-size: 18px;
    line-height: 1.2;
  }
  .title p {
    font-size: 13px;
    margin-top: 2px;
  }
  
  .banner, .delivery-note {
    padding: 14px 12px;
    font-size: 16px;
  }
  
  /* Cards maiores para toque f√°cil */
  .card {
    padding: 18px;
    min-height: auto;
    margin-bottom: 20px;
  }
  .thumb {
    height: 260px;
  }
  .combo-card .thumb {
    height: 200px;
  }
  
  /* Bot√µes muito maiores */
  .add-btn {
    padding: 18px 16px;
    font-size: 18px;
    min-height: 60px;
    display: flex;
    align-items: center;
    justify-content: center;
  }
  
  /* Controles de quantidade maiores */
  .qty {
    padding: 10px;
  }
  .qty button {
    width: 50px;
    height: 50px;
    font-size: 26px;
  }
  .qty .n {
    font-size: 20px;
    min-width: 50px;
  }
  
  /* Texto maior */
  .nome {
    font-size: 18px;
  }
  .preco {
    font-size: 20px;
  }
  
  /* Sabores maiores */
  .sabor-item {
    padding: 14px 18px;
    font-size: 16px;
    margin: 4px;
  }
  .sabor-item input[type="checkbox"] {
    transform: scale(1.5);
    margin-right: 12px;
  }
  
  /* Passos mais leg√≠veis */
  .step {
    font-size: 15px;
    padding: 10px 14px;
    margin: 4px;
  }
  
  /* Carrinho melhorado */
  .mini-thumb {
    width: 70px;
    height: 55px;
  }
  .cart-meta .cname {
    font-size: 16px;
  }
  #whatsapp-btn {
    padding: 18px;
    font-size: 18px;
    min-height: 60px;
    display: flex;
    align-items: center;
    justify-content: center;
  }
  
  /* FAB maior */
  .fab {
    width: 75px;
    height: 75px;
    border-radius: 22px;
  }
  .fab .badge {
    width: 32px;
    height: 32px;
    font-size: 16px;
  }
  
  /* Instru√ß√µes mais vis√≠veis */
  .instructions-box {
    padding: 18px;
    font-size: 16px;
  }
  
  /* Ajuste do zoom - garantir que tudo seja leg√≠vel */
  * {
    -webkit-tap-highlight-color: rgba(0,0,0,0.1);
  }
  input, select, textarea, button {
    font-size: 16px !important; /* Evita zoom no iOS */
  }
}

/* Garantir que os grids sejam centralizados no celular */
@media (max-width:420px){
  .combos-grid, .kits-grid, .produtos {
    padding-left:0;
    padding-right:0;
  }
  .card, .combo-card {
    width: 100%;
  }
}

/* Pequenas melhorias de usabilidade */
:focus {
  outline: 2px solid var(--orange);
  outline-offset: 2px;
}
button, [role="button"] {
  cursor: pointer;
}
</style>
</head>
<body>

<header>
  <div class="logo">
    <img src="images/logo-doce-confete.jpg" alt="logo"
         onerror="this.onerror=null;this.src='data:image/svg+xml;charset=UTF-8,<svg xmlns=%22http://www.w3.org/2000/svg%22 width=%2272%22 height=%2272%22><rect width=%2272%22 height=%2272%22 fill=%22%23fff3d6%22/><text x=%2236%22 y=%2238%22 font-size=%2210%22 text-anchor=%22middle%22 fill=%22%236b3b1a%22>Logo</text></svg>'">
  </div>
  <div class="title"><h1>Doce Confete</h1><p>Encomendas, doces e salgados! ‚Äî finalize pelo WhatsApp</p></div>
</header>

<div class="banner">
  üöö Entrega e Retirada!
</div>

<div class="delivery-note">
  üí° Taxa de entrega √© <strong>√† parte</strong> ‚Äî o valor ser√° informado no chat quando confirmar o pedido.
</div>

<!-- CTA INICIAL MELHORADO -->
<div style="text-align:center;margin:18px 0;">
  <button id="cta-start" style="background:var(--orange);border:none;color:#fff;padding:18px 24px;border-radius:12px;font-weight:900;font-size:20px;cursor:pointer;box-shadow:0 8px 20px rgba(255,106,0,0.3);display:inline-flex;align-items:center;gap:10px;margin:0 auto;">
    <span>üëâ</span> CLIQUE AQUI PARA COME√áAR SEU PEDIDO
  </button>
  <p style="margin-top:12px;color:#666;font-size:15px;">√â f√°cil e r√°pido! Siga os passos abaixo:</p>
</div>

<!-- INSTRU√á√ïES CLARAS -->
<div class="instructions-box">
  <h3>Como fazer seu pedido:</h3>
  <ol style="margin:12px 0;padding-left:20px;">
    <li><strong>Escolha os produtos</strong> que deseja (salgados, doces, kits)</li>
    <li><strong>Selecione os sabores</strong> de cada produto</li>
    <li><strong>Clique em "Adicionar ao pedido"</strong></li>
    <li><strong>Revise seu carrinho</strong> e finalize pelo WhatsApp</li>
  </ol>
</div>

<main>
  <div>
    <!-- STEP INDICATOR -->
    <div class="steps" aria-hidden="false">
      <div class="step-list">
        <div class="step active">1. Escolha os produtos</div>
        <div class="step">2. Selecione os sabores</div>
        <div class="step">3. Finalize o pedido</div>
      </div>
    </div>

    <!-- CONTAINER PARA SABORES DOS KITS (ser√° injetado dinamicamente) -->
    <div id="kit-sabores-dinamico"></div>

    <!-- SALGADOS -->
    <section id="salgados-section">
      <h2 style="margin:0 0 12px 0;color:var(--brown-dark);display:flex;align-items:center;gap:8px;">
        <span>üçï</span> Salgados
      </h2>
      <div class="alert alert-info">
        <span>üí°</span> Escolha a por√ß√£o e depois <strong>selecione os sabores abaixo</strong> antes de adicionar ao carrinho.
      </div>
      <div class="produtos" id="produtos"></div>
    </section>

    <!-- SABORES DOS SALGADOS -->
    <section class="sabores" id="sabores-salgados">
      <h3 style="display:flex;align-items:center;gap:8px;">
        <span>üëá</span> Escolha os sabores dos Salgados
      </h3>
      <div class="sabor-todos">
        <label class="sabor-item" style="border-style:dashed;background:#fffbe6;flex:1;">
          <input type="checkbox" id="salgados_todos"> <strong>Selecionar todos os sabores</strong>
        </label>
      </div>
      <div class="sabor-list" id="sabor-list-salgados"></div>
      <p style="margin-top:12px;font-size:14px;color:var(--muted);padding:8px;background:#f9f9f9;border-radius:8px;">
        <strong>Dica:</strong> Selecione todos os sabores que voc√™ quer na por√ß√£o. Depois escolha a quantidade e clique em "Adicionar ao pedido".
      </p>
    </section>

    <!-- DOCES -->
    <section id="doces-section" style="margin-top:24px">
      <h2 style="margin:0 0 12px 0;color:var(--brown-dark);display:flex;align-items:center;gap:8px;">
        <span>üç¨</span> Doces
      </h2>
      <div class="alert alert-info">
        <span>üí°</span> Escolha a por√ß√£o e depois <strong>selecione os sabores abaixo</strong> antes de adicionar ao carrinho.
      </div>
      <div class="produtos" id="produtos-doces"></div>
    </section>

    <!-- SABORES DOS DOCES -->
    <section class="sabores" id="sabores-doces">
      <h3 style="display:flex;align-items:center;gap:8px;">
        <span>üëá</span> Escolha os sabores dos Doces
      </h3>
      <div class="sabor-todos">
        <label class="sabor-item" style="border-style:dashed;background:#fffbe6;flex:1;">
          <input type="checkbox" id="doces_todos"> <strong>Selecionar todos os sabores</strong>
        </label>
      </div>
      <div class="sabor-list" id="sabor-list-doces"></div>
    </section>

    <!-- COMBOS -->
    <section class="combos" id="combos-visual" style="margin-top:24px">
      <h2 style="margin-top:0;color:var(--brown-dark);display:flex;align-items:center;gap:8px;">
        <span>üéâ</span> Combos Prontos
      </h2>
      <div class="combos-grid" id="combos-grid"></div>
    </section>

    <!-- KIT FESTA - AGORA COM SABORES VIS√çVEIS -->
    <section class="combos" id="kit-festa" style="margin-top:24px">
      <h2 style="margin-top:0;color:var(--brown-dark);display:flex;align-items:center;gap:8px;">
        <span>üéÅ</span> Kit Festa (Para muitas pessoas)
      </h2>
      
      <div class="alert alert-warning">
        <span>‚ö†Ô∏è</span> <strong>ATEN√á√ÉO:</strong> Ao escolher um kit, voc√™ <strong>PRECISA</strong> selecionar os sabores de salgados e doces que deseja. Os sabores aparecer√£o aqui automaticamente quando voc√™ clicar em um kit.
      </div>
      
      <div class="kits-grid" id="kits-grid"></div>
    </section>

    <!-- MINI CHURROS -->
    <section class="combos page-break" id="mini-churros-section" style="margin-top:24px">
      <h2 style="margin-top:0;color:var(--brown-dark);display:flex;align-items:center;gap:8px;">
        <span>üç©</span> Mini Churros
      </h2>
      <div style="display:flex;flex-direction:column;gap:16px;margin-top:16px">
        <div id="mini-churros-list"></div>
      </div>
    </section>

  </div>

  <!-- CARRINHO LATERAL -->
  <aside id="carrinho">
    <h2 style="display:flex;align-items:center;gap:8px;margin-top:0;">üõí Seu Carrinho</h2>
    <ul id="lista-carrinho"></ul>
    <p id="total">Total: R$ 0,00</p>
    <a id="whatsapp-btn" href="#" target="_blank" rel="noopener noreferrer">
      <span>üì±</span> Ver meu pedido e enviar pelo WhatsApp
    </a>
    <p style="font-size:14px;color:var(--muted);margin-top:12px;padding:10px;background:#f9f9f9;border-radius:8px;">
      <strong>Informa√ß√µes importantes:</strong> Antes de enviar, voc√™ precisar√° informar seu nome, tipo (retirada/entrega) e op√ß√£o de pagamento. A taxa de entrega ser√° informada no chat do WhatsApp.
    </p>
  </aside>
</main>

<!-- MODAL DE FINALIZA√á√ÉO (mantido igual) -->
<div id="modal" style="display:none;position:fixed;inset:0;background:rgba(0,0,0,0.5);align-items:center;justify-content:center;z-index:9998;padding:20px;">
  <div style="background:white;padding:24px;border-radius:16px;max-width:620px;width:100%;box-shadow:0 15px 40px rgba(0,0,0,0.2);max-height:90vh;overflow-y:auto;">
    <h3 style="margin:0 0 12px 0;color:var(--brown-dark);font-size:22px;">Finalizar pedido</h3>
    <p style="margin:0 0 20px 0;color:#444;font-size:16px;">Complete as informa√ß√µes abaixo para enviar seu pedido:</p>

    <div style="margin-bottom:16px">
      <label style="font-weight:700;display:block;margin-bottom:10px;font-size:16px;">Como deseja receber?</label>
      <div style="display:flex;gap:16px;flex-wrap:wrap;">
        <label style="display:flex;align-items:center;gap:10px;padding:12px 16px;background:#f9f9f9;border-radius:8px;flex:1;min-width:120px;">
          <input id="tipo-retirada" type="radio" name="tipo_entrega" value="Retirada" checked style="width:20px;height:20px;"> Retirada
        </label>
        <label style="display:flex;align-items:center;gap:10px;padding:12px 16px;background:#f9f9f9;border-radius:8px;flex:1;min-width:120px;">
          <input id="tipo-entrega" type="radio" name="tipo_entrega" value="Entrega" style="width:20px;height:20px;"> Entrega
        </label>
      </div>
      <div id="entrega-note" class="note-small field-hidden" style="margin-top:8px;color:#666;">Entrega dispon√≠vel.</div>
    </div>

    <div style="margin-bottom:16px">
      <label style="font-weight:700;display:block;margin-bottom:10px;font-size:16px;">Pedido para:</label>
      <div style="display:flex;gap:16px;flex-wrap:wrap;">
        <label style="display:flex;align-items:center;gap:10px;padding:12px 16px;background:#f9f9f9;border-radius:8px;flex:1;min-width:120px;">
          <input id="pedido-hoje" type="radio" name="tipo_pedido" value="hoje" checked style="width:20px;height:20px;"> Para hoje
        </label>
        <label style="display:flex;align-items:center;gap:10px;padding:12px 16px;background:#f9f9f9;border-radius:8px;flex:1;min-width:120px;">
          <input id="pedido-agendado" type="radio" name="tipo_pedido" value="agendado" style="width:20px;height:20px;"> Agendar
        </label>
      </div>
    </div>

    <div id="data-agendada-wrap" class="field-hidden" style="margin-bottom:16px">
      <label style="font-weight:700;display:block;margin-bottom:8px;font-size:16px;">Data para retirada/entrega:</label>
      <input id="data-agendada" type="date" style="width:100%;padding:14px;border-radius:10px;border:2px solid #ddd;font-size:16px;" />
    </div>

    <div style="margin-bottom:16px">
      <label style="font-weight:700;display:block;margin-bottom:8px;font-size:16px;">Hora desejada (opcional):</label>
      <input id="hora-pedido" type="time" style="width:100%;padding:14px;border-radius:10px;border:2px solid #ddd;font-size:16px;" />
    </div>

    <div style="margin-bottom:16px">
      <label style="font-weight:700;display:block;margin-bottom:8px;font-size:16px;">Seu nome completo:</label>
      <input id="cliente-nome" placeholder="Digite seu nome (obrigat√≥rio)" style="width:100%;padding:14px;border-radius:10px;border:2px solid #ddd;font-size:16px;" />
    </div>

    <div id="endereco-wrap" class="field-hidden" style="margin-bottom:16px">
      <label style="font-weight:700;display:block;margin-bottom:8px;font-size:16px;">Endere√ßo completo para entrega:</label>
      <input id="cliente-endereco" placeholder="Rua, n√∫mero, bairro, complemento..." style="width:100%;padding:14px;border-radius:10px;border:2px solid #ddd;font-size:16px;" />
      <div style="margin-top:8px;font-size:14px;color:#666;">Por favor inclua rua, n√∫mero, bairro e ponto de refer√™ncia.</div>
    </div>

    <div style="margin-bottom:20px">
      <label style="font-weight:700;display:block;margin-bottom:12px;font-size:16px;">Forma de pagamento:</label>
      <div style="display:flex;gap:12px;flex-wrap:wrap;">
        <label style="display:flex;align-items:center;gap:10px;padding:12px 16px;background:#f9f9f9;border-radius:8px;flex:1;min-width:100px;">
          <input id="pay-pix" type="radio" name="pagamento" value="PIX" checked style="width:20px;height:20px;"> PIX
        </label>
        <label style="display:flex;align-items:center;gap:10px;padding:12px 16px;background:#f9f9f9;border-radius:8px;flex:1;min-width:100px;">
          <input id="pay-cartao" type="radio" name="pagamento" value="Cart√£o" style="width:20px;height:20px;"> Cart√£o
        </label>
        <label style="display:flex;align-items:center;gap:10px;padding:12px 16px;background:#f9f9f9;border-radius:8px;flex:1;min-width:100px;">
          <input id="pay-dinheiro" type="radio" name="pagamento" value="Dinheiro" style="width:20px;height:20px;"> Dinheiro
        </label>
      </div>
      <div id="pix-only-note" class="note-small field-hidden" style="margin-top:8px;color:#666;background:#fff3cd;padding:10px;border-radius:8px;">
        üí° O valor da entrega ser√° informado no chat do WhatsApp. Por favor informe seu bairro no endere√ßo.
      </div>
    </div>

    <div style="display:flex;gap:12px;justify-content:flex-end;margin-top:24px">
      <button id="cancel-modal" style="background:#eee;border:none;padding:14px 20px;border-radius:10px;cursor:pointer;font-size:16px;font-weight:600;flex:1;">Cancelar</button>
      <button id="confirm-modal" style="background:var(--brown);color:white;border:none;padding:14px 20px;border-radius:10px;cursor:pointer;font-size:16px;font-weight:600;flex:2;">üì§ Enviar pedido pelo WhatsApp</button>
    </div>
  </div>
</div>

<!-- FAB + TOAST -->
<div class="fab" id="fab" title="Ver carrinho">
  <svg width="30" height="30" viewBox="0 0 24 24" fill="none"><path d="M7 4h-2l-1 2h2l1.2 6.4A3 3 0 0 0 10.2 15h7.1a3 3 0 0 0 2.9-2.4L22 6H7z" fill="#fff"/><circle cx="10.5" cy="19.5" r="1.5" fill="#fff"/><circle cx="17.5" cy="19.5" r="1.5" fill="#fff"/></svg>
  <div class="badge" id="fab-count">0</div>
</div>
<div class="toast" id="toast">‚úÖ Adicionado ao carrinho!</div>

<script>
/* === DADOS (ajustados conforme pedido) === */
const produtosData = [
  {id:'p25',nome:'25 Salgados',preco:20.00, img:'images/25-salgados.jpg', categoria:'salgado'},
  {id:'p50',nome:'50 Salgados (Meio Cento)',preco:30.00, img:'images/50-salgados.jpg', categoria:'salgado'},
  {id:'p100',nome:'100 Salgados (Cento)',preco:50.00, precoOriginal:60.00, img:'images/100-salgados.jpg', categoria:'salgado', promo:true}
];

const docesData = [
  {id:'d40',nome:'40 Doces',preco:40.00,img:'images/40-doces.jpg', categoria:'doce'},
  {id:'d50',nome:'50 Doces',preco:50.00,img:'images/50-doces.jpg', categoria:'doce'},
  {id:'d100',nome:'100 Doces',preco:100.00,img:'images/100-doces.jpg', categoria:'doce'}
];

const combosData = [
  { id:'combo_fome', nome:'To com Fome', preco:19.00, img:'images/combo_fome.jpg', desc:'20 salgados + 10 mini churros' },
  { id:'combo_delicia', nome:'Del√≠cia da Casa', preco:35.00, img:'images/combo_delicia.jpg', desc:'40 salgados + 10 mini churros' },
  { id:'combo_festa', nome:'Festa Total', preco:55.00, img:'images/combo_festa.jpg', desc:'100 salgados + 10 mini churros' }
];

const kitsData = [
  { id:'kit_5', nome:'Kit 5 pessoas', preco:70.00, img:'images/5-pessoas.jpg', desc:'50 salgados + 40 doces' },
  { id:'kit_10_15', nome:'Kit 10‚Äì15 pessoas', preco:100.00, img:'images/10-pessoas.jpg', desc:'100 salgados + 50 doces' },
  { id:'kit_20', nome:'Kit 20 pessoas', preco:180.00, img:'images/20-pessoas.jpg', desc:'200 salgados + 80 docinhos' },
  { id:'kit_40', nome:'Kit 40 pessoas', preco:360.00, img:'images/40-pessoas.jpg', desc:'400 salgados + 160 docinhos' },
  { id:'kit_lanche', nome:'Kit Lanche', preco:45.00, img:'images/kit-lanche.jpg', desc:'50 salgados + 15 docinhos' }
];

const miniChurrosData = [
  {id:'c10', nome:'Po√ß√£o 10 Mini Churros', preco:9.99, img:'images/mini-churros-10.jpg'},
  {id:'c50', nome:'Po√ß√£o 50 Mini Churros', preco:29.00, img:'images/mini-churros-50.jpg'},
  {id:'c100', nome:'Po√ß√£o 100 Mini Churros', preco:50.90, img:'images/mini-churros-100.jpg'},
  {id:'kit2', nome:'Kit com 2 Churros Gourmet', preco:9.00, img:'images/kit-churros-2.jpg'}
];

const saboresSalgado = [
  'Coxinha','Medalh√£o de Salsicha','Pastel de Carne com A√ß√∫car','Pastel de Carne',
  'Bolinha de Queijo','Bal√£o de Pizza','Travesseiro de Carne'
];

const saboresDoce = [
  'Ferrero Rocher','Prest√≠gio','Beijinho','Casadinho','Churros','Brigadeiro','Ninho'
];

/* VARI√ÅVEIS GLOBAIS */
const carrinho = new Map();
let kitSelecionadoAtual = null;
let saboresSelecionados = {
  salgados: [],
  doces: []
};

/* FUN√á√ïES DE FORMATA√á√ÉO */
function formatBRL(n){ return Number(n).toLocaleString('pt-BR',{style:'currency',currency:'BRL'}); }

/* ====== RENDER SALGADOS ====== */
const produtosContainer = document.getElementById('produtos');
produtosData.forEach(p=>{
  const card = document.createElement('div'); card.className='card';
  const hasPromo = p.precoOriginal && p.precoOriginal > p.preco;
  card.innerHTML = `
    <div class="thumb">
      <img src="${p.img}" alt="${p.nome}" onerror="this.onerror=null;this.src='data:image/svg+xml;charset=UTF-8,<svg xmlns=%22http://www.w3.org/2000/svg%22 width=%22240%22 height=%22220%22><rect width=%22240%22 height=%22220%22 fill=%22%23f6f6f6%22/><text x=%22120%22 y=%22110%22 font-size=%2214%22 text-anchor=%22middle%22 fill=%22%23666%22>Sem imagem</text></svg>'">
      ${hasPromo ? `<span class="promo-badge">üî• PROMO√á√ÉO</span>` : ''}
    </div>
    <div class="info">
      <div class="nome">${p.nome}</div>
      <div class="preco">${formatBRL(p.preco)}</div>
    </div>
    ${hasPromo ? `<div style="margin-top:-4px"><span class="preco-old">${formatBRL(p.precoOriginal)}</span></div>` : ''}
    <div class="controle">
      <div class="qty" data-id="${p.id}">
        <button class="minus">‚àí</button>
        <div class="n">0</div>
        <button class="plus">+</button>
      </div>
      <button class="add-btn" data-id="${p.id}" data-categoria="${p.categoria}">Adicionar ao pedido</button>
    </div>
    <div class="qty-selector">
      <select data-id="${p.id}" style="width:100%">
        <option value="1">1 unidade</option>
        <option value="2">2 unidades</option>
        <option value="3">3 unidades</option>
        <option value="4">4 unidades</option>
        <option value="5">5 unidades</option>
        <option value="6">6 unidades</option>
        <option value="7">7 unidades</option>
        <option value="8">8 unidades</option>
        <option value="9">9 unidades</option>
        <option value="10">10 unidades</option>
      </select>
    </div>`;
  produtosContainer.appendChild(card);

  const qtyEl = card.querySelector('.qty'); 
  const nEl = qtyEl.querySelector('.n');
  const selectEl = card.querySelector('select');
  
  // Sincronizar select com display
  selectEl.addEventListener('change', (e) => {
    nEl.textContent = e.target.value;
  });
  
  qtyEl.querySelector('.minus').addEventListener('click',()=>{ 
    let n=parseInt(nEl.textContent,10); 
    if(n>1) n--; 
    nEl.textContent=n;
    selectEl.value = n;
  });
  
  qtyEl.querySelector('.plus').addEventListener('click',()=>{ 
    let n=parseInt(nEl.textContent,10); 
    n++; 
    nEl.textContent=n;
    selectEl.value = n;
  });
  
  card.querySelector('.add-btn').addEventListener('click', (ev)=>{
    const qty=parseInt(nEl.textContent,10);
    const cid = ev.currentTarget.dataset.id;
    const categoria = ev.currentTarget.dataset.categoria;
    
    if(qty <= 0){ 
      showToast('‚ùå Selecione uma quantidade primeiro!', 'error');
      return; 
    }
    
    // Verificar sabores selecionados
    const sabores = getSelectedSabores('salgados_sabor');
    if(!sabores.length){ 
      showToast('‚ùå Selecione pelo menos um sabor de salgados!', 'error');
      document.getElementById('sabores-salgados').scrollIntoView({behavior:'smooth'});
      
      // Destacar a se√ß√£o de sabores
      document.getElementById('sabores-salgados').style.backgroundColor = '#fff9e6';
      setTimeout(() => {
        document.getElementById('sabores-salgados').style.backgroundColor = '';
      }, 2000);
      
      return; 
    }
    
    adicionarAoCarrinho(cid,qty,null,{salgados: sabores},'salgado');
  });
});

/* ====== RENDER SABORES DOS SALGADOS (checkboxes) ====== */
const saborListSalgados = document.getElementById('sabor-list-salgados');
saboresSalgado.forEach((s,idx)=>{
  const id = `salgado_sabor_${idx}`;
  const wrap = document.createElement('label'); 
  wrap.className='sabor-item';
  wrap.innerHTML = `<input type="checkbox" name="salgados_sabor" id="${id}" value="${s}"> ${s}`;
  saborListSalgados.appendChild(wrap);
  
  // Adicionar evento para atualizar sabores selecionados
  wrap.querySelector('input').addEventListener('change', function() {
    if(this.checked) {
      if(!saboresSelecionados.salgados.includes(s)) {
        saboresSelecionados.salgados.push(s);
      }
    } else {
      saboresSelecionados.salgados = saboresSelecionados.salgados.filter(item => item !== s);
    }
    updateKitSaboresDisplay();
  });
});

document.getElementById('salgados_todos').addEventListener('change', (e)=>{
  const checked = e.target.checked;
  document.querySelectorAll('input[name="salgados_sabor"]').forEach(i=> i.checked = checked);
  
  // Atualizar sabores selecionados
  if(checked) {
    saboresSelecionados.salgados = [...saboresSalgado];
  } else {
    saboresSelecionados.salgados = [];
  }
  updateKitSaboresDisplay();
});

document.getElementById('sabor-list-salgados').addEventListener('change', ()=>{
  const all = Array.from(document.querySelectorAll('input[name="salgados_sabor"]'));
  const todos = all.length && all.every(i=>i.checked);
  document.getElementById('salgados_todos').checked = !!todos;
});

/* ====== RENDER DOCES ====== */
const produtosDocesContainer = document.getElementById('produtos-doces');
docesData.forEach(p=>{
  const card = document.createElement('div'); card.className='card';
  card.innerHTML = `
    <div class="thumb">
      <img src="${p.img}" alt="${p.nome}" onerror="this.onerror=null;this.src='data:image/svg+xml;charset=UTF-8,<svg xmlns=%22http://www.w3.org/2000/svg%22 width=%22240%22 height=%22220%22><rect width=%22240%22 height=%22220%22 fill=%22%23f6f6f6%22/><text x=%22120%22 y=%22110%22 font-size=%2214%22 text-anchor=%22middle%22 fill=%22%23666%22>Sem imagem</text></svg>'">
    </div>
    <div class="info">
      <div class="nome">${p.nome}</div>
      <div class="preco">${formatBRL(p.preco)}</div>
    </div>
    <div class="controle">
      <div class="qty" data-id="${p.id}">
        <button class="minus">‚àí</button>
        <div class="n">0</div>
        <button class="plus">+</button>
      </div>
      <button class="add-btn" data-id="${p.id}" data-categoria="${p.categoria}">Adicionar ao pedido</button>
    </div>
    <div class="qty-selector">
      <select data-id="${p.id}" style="width:100%">
        <option value="1">1 unidade</option>
        <option value="2">2 unidades</option>
        <option value="3">3 unidades</option>
        <option value="4">4 unidades</option>
        <option value="5">5 unidades</option>
        <option value="6">6 unidades</option>
        <option value="7">7 unidades</option>
        <option value="8">8 unidades</option>
        <option value="9">9 unidades</option>
        <option value="10">10 unidades</option>
      </select>
    </div>`;
  produtosDocesContainer.appendChild(card);

  const qtyEl = card.querySelector('.qty'); 
  const nEl = qtyEl.querySelector('.n');
  const selectEl = card.querySelector('select');
  
  selectEl.addEventListener('change', (e) => {
    nEl.textContent = e.target.value;
  });
  
  qtyEl.querySelector('.minus').addEventListener('click',()=>{ 
    let n=parseInt(nEl.textContent,10); 
    if(n>1) n--; 
    nEl.textContent=n;
    selectEl.value = n;
  });
  
  qtyEl.querySelector('.plus').addEventListener('click',()=>{ 
    let n=parseInt(nEl.textContent,10); 
    n++; 
    nEl.textContent=n;
    selectEl.value = n;
  });
  
  card.querySelector('.add-btn').addEventListener('click', (ev)=>{
    const qty=parseInt(nEl.textContent,10);
    const cid = ev.currentTarget.dataset.id;
    const categoria = ev.currentTarget.dataset.categoria;
    
    if(qty <= 0){ 
      showToast('‚ùå Selecione uma quantidade primeiro!', 'error');
      return; 
    }
    
    const sabores = getSelectedSabores('doces_sabor');
    if(!sabores.length){ 
      showToast('‚ùå Selecione pelo menos um sabor de doces!', 'error');
      document.getElementById('sabores-doces').scrollIntoView({behavior:'smooth'});
      
      // Destacar a se√ß√£o de sabores
      document.getElementById('sabores-doces').style.backgroundColor = '#fff9e6';
      setTimeout(() => {
        document.getElementById('sabores-doces').style.backgroundColor = '';
      }, 2000);
      
      return; 
    }
    
    adicionarAoCarrinho(cid,qty,null,{doces: sabores},'doce');
  });
});

/* ====== RENDER SABORES DOS DOCES (checkboxes) ====== */
const saborListDoces = document.getElementById('sabor-list-doces');
saboresDoce.forEach((s,idx)=>{
  const id = `doce_sabor_${idx}`;
  const wrap = document.createElement('label'); wrap.className='sabor-item';
  wrap.innerHTML = `<input type="checkbox" name="doces_sabor" id="${id}" value="${s}"> ${s}`;
  saborListDoces.appendChild(wrap);
  
  // Adicionar evento para atualizar sabores selecionados
  wrap.querySelector('input').addEventListener('change', function() {
    if(this.checked) {
      if(!saboresSelecionados.doces.includes(s)) {
        saboresSelecionados.doces.push(s);
      }
    } else {
      saboresSelecionados.doces = saboresSelecionados.doces.filter(item => item !== s);
    }
    updateKitSaboresDisplay();
  });
});

document.getElementById('doces_todos').addEventListener('change', (e)=>{
  const checked = e.target.checked;
  document.querySelectorAll('input[name="doces_sabor"]').forEach(i=> i.checked = checked);
  
  // Atualizar sabores selecionados
  if(checked) {
    saboresSelecionados.doces = [...saboresDoce];
  } else {
    saboresSelecionados.doces = [];
  }
  updateKitSaboresDisplay();
});

document.getElementById('sabor-list-doces').addEventListener('change', ()=>{
  const all = Array.from(document.querySelectorAll('input[name="doces_sabor"]'));
  const todos = all.length && all.every(i=>i.checked);
  document.getElementById('doces_todos').checked = !!todos;
});

/* ====== RENDER COMBOS ====== */
const combosGrid = document.getElementById('combos-grid');
combosData.forEach(c=>{
  const card = document.createElement('div'); card.className='combo-card';
  card.innerHTML = `
    <div class="thumb"><img src="${c.img}" alt="${c.nome}" onerror="this.onerror=null;this.src='data:image/svg+xml;charset=UTF-8,<svg xmlns=%22http://www.w3.org/2000/svg%22 width=%22360%22 height=%22160%22><rect width=%22360%22 height=%22160%22 fill=%22%23f6f6f6%22/><text x=%22180%22 y=%2280%22 font-size=%2214%22 text-anchor=%22middle%22 fill=%22%23666%22>Sem imagem</text></svg>'"></div>
    <div style="display:flex;justify-content:space-between;align-items:center;">
      <div>
        <div style="font-weight:900;color:var(--orange)">${c.nome}</div>
        <div style="font-size:14px;color:var(--muted);margin-top:4px;">${c.desc || ''}</div>
      </div>
      <div style="text-align:right">
        <div style="font-weight:900;color:var(--brown-dark);font-size:18px;">${formatBRL(c.preco)}</div>
        <button class="add-btn combo-add" data-id="${c.id}" style="margin-top:12px;width:100%">Adicionar ao pedido</button>
      </div>
    </div>`;
  combosGrid.appendChild(card);
  card.querySelector('.combo-add').addEventListener('click', ()=> {
    adicionarAoCarrinho(c.id,1,{nome:c.nome,preco:c.preco,img:c.img},[],null);
  });
});

/* ====== RENDER KITS (Kit Festa) - COM NOVA FUNCIONALIDADE ====== */
const kitsGrid = document.getElementById('kits-grid');
kitsData.forEach(k=>{
  const card = document.createElement('div'); 
  card.className='combo-card';
  card.dataset.kitId = k.id;
  
  card.innerHTML = `
    <div class="thumb"><img src="${k.img}" alt="${k.nome}" onerror="this.onerror=null;this.src='data:image/svg+xml;charset=UTF-8,<svg xmlns=%22http://www.w3.org/2000/svg%22 width=%22360%22 height=%22160%22><rect width=%22360%22 height=%22160%22 fill=%22%23f6f6f6%22/><text x=%22180%22 y=%2280%22 font-size=%2214%22 text-anchor=%22middle%22 fill=%22%23666%22>Sem imagem</text></svg>'"></div>
    <div style="display:flex;justify-content:space-between;align-items:center;">
      <div>
        <div style="font-weight:900;color:var(--orange);font-size:18px;">${k.nome}</div>
        <div style="font-size:14px;color:var(--muted);margin-top:4px;">${k.desc || ''}</div>
        <div style="margin-top:6px;font-size:16px;font-weight:900;color:var(--brown-dark)">${formatBRL(k.preco)}</div>
      </div>
    </div>
    <button class="add-btn kit-select-btn" data-id="${k.id}" style="margin-top:8px;width:100%;">
      <span>üëá</span> ESCOLHER ESTE KIT
    </button>`;
  
  kitsGrid.appendChild(card);
  
  // NOVO: Quando clicar no kit, mostrar os sabores
  card.querySelector('.kit-select-btn').addEventListener('click', (e)=>{
    e.preventDefault();
    
    // Definir kit selecionado
    kitSelecionadoAtual = k;
    
    // Destacar o card selecionado
    document.querySelectorAll('.combo-card').forEach(c => {
      c.classList.remove('card-highlight');
    });
    card.classList.add('card-highlight');
    
    // Mostrar se√ß√£o de sabores para o kit
    mostrarSaboresParaKit(k);
    
    // Rolagem suave para a se√ß√£o de sabores
    document.getElementById('kit-sabores-dinamico').scrollIntoView({ 
      behavior: 'smooth', 
      block: 'start' 
    });
    
    // Atualizar display dos sabores
    updateKitSaboresDisplay();
  });
});

/* ====== FUN√á√ÉO PARA MOSTRAR SABORES PARA O KIT ====== */
function mostrarSaboresParaKit(kit) {
  const container = document.getElementById('kit-sabores-dinamico');
  
  container.innerHTML = `
    <div class="kit-sabores-container">
      <div class="kit-sabores-header">
        <h3>üéØ Voc√™ escolheu: ${kit.nome}</h3>
        <button id="fechar-sabores" style="background:#eee;border:none;padding:8px 12px;border-radius:8px;cursor:pointer;font-size:14px;">
          ‚úï Fechar
        </button>
      </div>
      
      <div class="alert alert-info">
        <span>üìù</span> <strong>Agora selecione os sabores que voc√™ quer neste kit:</strong> Escolha pelo menos um sabor de salgados e um de doces.
      </div>
      
      <div class="sabores-section">
        <div class="sabor-group">
          <h4>Sabores de Salgados</h4>
          <div class="sabor-list" id="kit-sabores-salgados"></div>
        </div>
        
        <div class="sabor-group">
          <h4>Sabores de Doces</h4>
          <div class="sabor-list" id="kit-sabores-doces"></div>
        </div>
      </div>
      
      <div style="display:flex;align-items:center;gap:12px;margin-top:20px;padding-top:20px;border-top:2px dashed #eee;">
        <div style="flex:1;font-size:16px;">
          <strong>Seus sabores selecionados:</strong>
          <div id="sabores-selecionados-display" style="margin-top:8px;color:#666;">
            <em>Nenhum sabor selecionado ainda</em>
          </div>
        </div>
        
        <button id="adicionar-kit-com-sabores" class="add-btn" style="min-width:200px;padding:16px 24px;">
          <span>‚úÖ</span> ADICIONAR KIT AO PEDIDO
        </button>
      </div>
      
      <div style="margin-top:12px;font-size:14px;color:#666;background:#f9f9f9;padding:10px;border-radius:8px;">
        <strong>Dica:</strong> Voc√™ pode selecionar quantos sabores quiser. Os sabores ser√£o misturados no seu kit.
      </div>
    </div>
  `;
  
  // Renderizar checkboxes para sabores de salgados
  const kitSaboresSalgados = document.getElementById('kit-sabores-salgados');
  saboresSalgado.forEach((s, idx) => {
    const isSelected = saboresSelecionados.salgados.includes(s);
    const wrap = document.createElement('label');
    wrap.className = `sabor-item ${isSelected ? 'selected' : ''}`;
    wrap.innerHTML = `
      <input type="checkbox" name="kit_salgados_sabor" value="${s}" ${isSelected ? 'checked' : ''}>
      ${s}
    `;
    kitSaboresSalgados.appendChild(wrap);
    
    wrap.querySelector('input').addEventListener('change', function() {
      if(this.checked) {
        if(!saboresSelecionados.salgados.includes(s)) {
          saboresSelecionados.salgados.push(s);
        }
        wrap.classList.add('selected');
      } else {
        saboresSelecionados.salgados = saboresSelecionados.salgados.filter(item => item !== s);
        wrap.classList.remove('selected');
      }
      updateKitSaboresDisplay();
    });
  });
  
  // Renderizar checkboxes para sabores de doces
  const kitSaboresDoces = document.getElementById('kit-sabores-doces');
  saboresDoce.forEach((s, idx) => {
    const isSelected = saboresSelecionados.doces.includes(s);
    const wrap = document.createElement('label');
    wrap.className = `sabor-item ${isSelected ? 'selected' : ''}`;
    wrap.innerHTML = `
      <input type="checkbox" name="kit_doces_sabor" value="${s}" ${isSelected ? 'checked' : ''}>
      ${s}
    `;
    kitSaboresDoces.appendChild(wrap);
    
    wrap.querySelector('input').addEventListener('change', function() {
      if(this.checked) {
        if(!saboresSelecionados.doces.includes(s)) {
          saboresSelecionados.doces.push(s);
        }
        wrap.classList.add('selected');
      } else {
        saboresSelecionados.doces = saboresSelecionados.doces.filter(item => item !== s);
        wrap.classList.remove('selected');
      }
      updateKitSaboresDisplay();
    });
  });
  
  // Bot√£o para adicionar kit com sabores
  document.getElementById('adicionar-kit-com-sabores').addEventListener('click', () => {
    if (!kitSelecionadoAtual) {
      showToast('‚ùå Nenhum kit selecionado!', 'error');
      return;
    }
    
    if (!saboresSelecionados.salgados.length) {
      showToast('‚ùå Selecione pelo menos um sabor de salgados!', 'error');
      document.querySelector('.sabor-group:first-child').scrollIntoView({behavior: 'smooth'});
      return;
    }
    
    if (!saboresSelecionados.doces.length) {
      showToast('‚ùå Selecione pelo menos um sabor de doces!', 'error');
      document.querySelector('.sabor-group:last-child').scrollIntoView({behavior: 'smooth'});
      return;
    }
    
    // Adicionar ao carrinho
    adicionarAoCarrinho(
      kitSelecionadoAtual.id,
      1,
      {nome: kitSelecionadoAtual.nome, preco: kitSelecionadoAtual.preco, img: kitSelecionadoAtual.img},
      {salgados: [...saboresSelecionados.salgados], doces: [...saboresSelecionados.doces]},
      'kit'
    );
    
    // Resetar sele√ß√£o
    resetarSelecaoKit();
  });
  
  // Bot√£o para fechar
  document.getElementById('fechar-sabores').addEventListener('click', () => {
    resetarSelecaoKit();
  });
}

/* ====== ATUALIZAR DISPLAY DOS SABORES SELECIONADOS ====== */
function updateKitSaboresDisplay() {
  const displayEl = document.getElementById('sabores-selecionados-display');
  if (!displayEl) return;
  
  const salgadosText = saboresSelecionados.salgados.length > 0 
    ? `<strong>Salgados:</strong> ${saboresSelecionados.salgados.join(', ')}` 
    : '<span style="color:#e74c3c;">‚ùå Nenhum sabor de salgados selecionado</span>';
  
  const docesText = saboresSelecionados.doces.length > 0 
    ? `<strong>Doces:</strong> ${saboresSelecionados.doces.join(', ')}` 
    : '<span style="color:#e74c3c;">‚ùå Nenhum sabor de doces selecionado</span>';
  
  displayEl.innerHTML = `
    <div>${salgadosText}</div>
    <div style="margin-top:6px;">${docesText}</div>
  `;
  
  // Atualizar bot√£o de adicionar
  const addBtn = document.getElementById('adicionar-kit-com-sabores');
  if (addBtn) {
    const podeAdicionar = saboresSelecionados.salgados.length > 0 && saboresSelecionados.doces.length > 0;
    addBtn.disabled = !podeAdicionar;
    addBtn.classList.toggle('disabled', !podeAdicionar);
    
    if (podeAdicionar) {
      addBtn.innerHTML = `<span>‚úÖ</span> ADICIONAR KIT AO PEDIDO`;
    } else {
      addBtn.innerHTML = `<span>‚è≥</span> SELECIONE OS SABORES`;
    }
  }
}

/* ====== RESETAR SELE√á√ÉO DO KIT ====== */
function resetarSelecaoKit() {
  kitSelecionadoAtual = null;
  document.getElementById('kit-sabores-dinamico').innerHTML = '';
  document.querySelectorAll('.combo-card').forEach(c => {
    c.classList.remove('card-highlight');
  });
}

/* ====== RENDER MINI CHURROS ====== */
const miniList = document.getElementById('mini-churros-list');
miniChurrosData.forEach(item=>{
  const wrap = document.createElement('div');
  wrap.style.display = 'flex';
  wrap.style.justifyContent = 'space-between';
  wrap.style.alignItems = 'center';
  wrap.style.gap = '12px';
  wrap.style.padding = '12px 0';
  wrap.style.borderBottom = '1px dashed #eee';

  wrap.innerHTML = `
    <div style="display:flex;gap:14px;align-items:center;flex:1">
      <div class="thumb" style="width:100px;height:75px;border-radius:8px;overflow:hidden;flex-shrink:0">
        <img src="${item.img}" alt="${item.nome}" style="width:100%;height:100%;object-fit:cover" onerror="this.onerror=null;this.src='data:image/svg+xml;charset=UTF-8,<svg xmlns=%22http://www.w3.org/2000/svg%22 width=%22100%22 height=%2275%22><rect width=%22100%22 height=%2275%22 fill=%22%23f6f6f6%22/><text x=%2250%22 y=%2245%22 font-size=%2212%22 text-anchor=%22middle%22 fill=%22%23666%22>Sem imagem</text></svg>'">
      </div>
      <div style="flex:1">
        <div style="font-weight:900;color:var(--orange);font-size:16px;">${item.nome}</div>
        <div style="font-size:15px;color:var(--brown-dark);font-weight:700;margin-top:4px;">${formatBRL(item.preco)}</div>
      </div>
    </div>
    <div style="display:flex;align-items:center;gap:10px">
      <div class="qty" data-id="${item.id}">
        <button class="minus">‚àí</button>
        <div class="n">0</div>
        <button class="plus">+</button>
      </div>
      <button class="add-btn mini-add" data-id="${item.id}" style="min-width:140px">Adicionar</button>
    </div>
    <div class="qty-selector" style="min-width:100px">
      <select data-id="${item.id}" style="width:100%">
        <option value="1">1</option>
        <option value="2">2</option>
        <option value="3">3</option>
        <option value="4">4</option>
        <option value="5">5</option>
        <option value="6">6</option>
        <option value="7">7</option>
        <option value="8">8</option>
        <option value="9">9</option>
        <option value="10">10</option>
      </select>
    </div>
  `;
  miniList.appendChild(wrap);

  const qtyEl = wrap.querySelector('.qty'); 
  const nEl = qtyEl.querySelector('.n');
  const selectEl = wrap.querySelector('select');
  
  selectEl.addEventListener('change', (e) => {
    nEl.textContent = e.target.value;
  });
  
  qtyEl.querySelector('.minus').addEventListener('click',()=>{ 
    let n=parseInt(nEl.textContent,10); 
    if(n>1) n--; 
    nEl.textContent=n;
    selectEl.value = n;
  });
  
  qtyEl.querySelector('.plus').addEventListener('click',()=>{ 
    let n=parseInt(nEl.textContent,10); 
    n++; 
    nEl.textContent=n;
    selectEl.value = n;
  });
  
  wrap.querySelector('.mini-add').addEventListener('click',()=>{ 
    const qty=parseInt(nEl.textContent,10); 
    if(qty <= 0){ 
      showToast('‚ùå Selecione uma quantidade!', 'error');
      return; 
    } 
    adicionarAoCarrinho(item.id,qty,{nome:item.nome,preco:item.preco,img:item.img},[],null);
  });
});

/* ====== CARRINHO: adicionar / remover / atualizar ====== */
function adicionarAoCarrinho(id,quant,override,flavors,categoria){
  // Normalizar flavors
  let flavorKey = '';
  let storedFlavors = null;

  if(!flavors) {
    storedFlavors = [];
    flavorKey = '';
  } else if(Array.isArray(flavors)){
    storedFlavors = flavors.map(f=>String(f).trim()).filter(Boolean);
    flavorKey = storedFlavors.join('|');
  } else if(typeof flavors === 'object'){
    const s = (flavors.salgados || []).map(x=>String(x).trim()).filter(Boolean);
    const d = (flavors.doces || []).map(x=>String(x).trim()).filter(Boolean);
    storedFlavors = {};
    if(s.length) storedFlavors.salgados = s;
    if(d.length) storedFlavors.doces = d;
    flavorKey = `S:${s.join(',')};D:${d.join(',')}`;
  } else {
    storedFlavors = [];
    flavorKey = '';
  }

  const key = `${id}__${flavorKey || ''}__${categoria || ''}`;

  if(override){
    if(carrinho.has(key)){ 
      const e=carrinho.get(key); 
      e.qty+=quant; 
      carrinho.set(key,e); 
    } else {
      carrinho.set(key,{
        produto:{nome:override.nome,preco:override.preco,img:override.img},
        qty:quant,
        flavors:storedFlavors,
        categoria:categoria
      });
    }
  } else {
    let prod = produtosData.find(x=>x.id===id) || docesData.find(x=>x.id===id) || miniChurrosData.find(x=>x.id===id);
    if(!prod){
      const combo = combosData.find(x=>x.id===id) || kitsData.find(x=>x.id===id);
      if(combo) prod = { id: combo.id, nome: combo.nome, preco: combo.preco, img: combo.img };
    }
    if(!prod) return;
    
    if(carrinho.has(key)){ 
      const e=carrinho.get(key); 
      e.qty+=quant; 
      carrinho.set(key,e); 
    } else {
      carrinho.set(key,{
        produto:prod,
        qty:quant,
        flavors:storedFlavors,
        categoria:categoria
      });
    }
  }
  
  showToast('‚úÖ Adicionado ao carrinho!', 'success');
  atualizarCarrinho();
  
  // Resetar sele√ß√£o do kit se foi um kit
  if (categoria === 'kit') {
    resetarSelecaoKit();
    saboresSelecionados = { salgados: [], doces: [] };
  }
}

function removerDoCarrinho(key){ 
  carrinho.delete(key); 
  atualizarCarrinho();
  showToast('üóëÔ∏è Item removido do carrinho', 'warning');
}

function atualizarCarrinho(){
  const lista=document.getElementById('lista-carrinho'); 
  lista.innerHTML='';
  const totalEl=document.getElementById('total'); 
  const waBtn=document.getElementById('whatsapp-btn');
  
  let total=0, count=0;
  
  if(carrinho.size===0){ 
    lista.innerHTML='<p style="color:#888;text-align:center;padding:20px;font-size:16px;">Seu carrinho est√° vazio<br><span style="font-size:14px;">Adicione algo delicioso! üòã</span></p>'; 
    totalEl.textContent='Total: R$ 0,00'; 
    waBtn.classList.add('small'); 
    waBtn.href='#'; 
    updateFab(0); 
    return; 
  }
  
  for(const [key,entry] of carrinho.entries()){
    const li=document.createElement('li');
    
    // Thumbnail
    const thumb=document.createElement('div'); thumb.className='mini-thumb';
    const img=document.createElement('img'); 
    img.src=entry.produto.img || ''; 
    img.alt=entry.produto.nome;
    img.onerror=function(){ 
      this.onerror=null;
      this.src='data:image/svg+xml;charset=UTF-8,<svg xmlns=%22http://www.w3.org/2000/svg%22 width=%2256%22 height=%2242%22><rect width=%2256%22 height=%2242%22 fill=%22%23f4f4f4%22/><text x=%2228%22 y=%2224%22 font-size=%2210%22 text-anchor=%22middle%22 fill=%22%23666%22>no img</text></svg>' 
    };
    thumb.appendChild(img);
    
    // Meta info
    const meta=document.createElement('div'); meta.className='cart-meta';
    let flavorText = '';
    
    if(entry.flavors){
      if(Array.isArray(entry.flavors) && entry.flavors.length){
        if(entry.categoria === 'salgado' && entry.flavors.length === saboresSalgado.length){
          flavorText = `Sabores: <strong>Todos os sabores</strong> ‚Ä¢ `;
        } else {
          flavorText = `Sabores: <strong>${entry.flavors.join(', ')}</strong> ‚Ä¢ `;
        }
      } else if(typeof entry.flavors === 'object'){
        const s = entry.flavors.salgados || [];
        const d = entry.flavors.doces || [];
        const sText = s.length ? s.join(', ') : '‚Äî';
        const dText = d.length ? d.join(', ') : '‚Äî';
        flavorText = `Salgados: <strong>${sText}</strong><br>Doces: <strong>${dText}</strong> ‚Ä¢ `;
      }
    }
    
    meta.innerHTML=`
      <div class="cname">${entry.produto.nome}</div>
      <div class="csub">${flavorText}Quantidade: <strong>${entry.qty}</strong> ‚Ä¢ Unit: ${formatBRL(entry.produto.preco)}</div>
    `;
    
    // Right side (subtotal and remove)
    const right=document.createElement('div'); right.className='cart-right';
    const subtotal=entry.qty*entry.produto.preco; 
    total+=subtotal; 
    count+=entry.qty;
    
    right.innerHTML=`
      <div class="subtotal">${formatBRL(subtotal)}</div>
      <div class="remove" data-key="${key}">Remover</div>
    `;
    
    li.appendChild(thumb); 
    li.appendChild(meta); 
    li.appendChild(right);
    
    li.querySelector('.remove').addEventListener('click', (ev)=>{ 
      removerDoCarrinho(ev.target.dataset.key); 
    });
    
    lista.appendChild(li);
  }
  
  totalEl.textContent=`Total: ${formatBRL(total)}`;

  // Montar mensagem para WhatsApp
  let mensagemTextPlain = `*PEDIDO - DOCE CONFET
