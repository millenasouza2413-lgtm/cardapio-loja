<!doctype html>
<html lang="pt-BR">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Doce Confete ‚Äî Card√°pio</title>

<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&family=Baloo+2:wght@400;700;800&display=swap" rel="stylesheet">

<style>
:root{
    --bg: #FFF9ED;
    --pastel-yellow: #FFEC8B;
    --brand-yellow: #FFC125;
    --brand-yellow-light: #FFE484;
    --brand-yellow-dark: #F9A825;
    --brown-dark: #5b220f;
    --brown-mid: #9d603b;
    --brown-light: #D4A574;
    --accent: #e5712a;
    --accent-hot: #FF6B35;
    --success: #27AE60;
    --card-radius: 18px;
    --shadow: 0 12px 30px rgba(91,34,15,0.12);
    --shadow-heavy: 0 16px 40px rgba(255, 193, 37, 0.25);
    --gradient-yellow: linear-gradient(135deg, var(--brand-yellow), #FFD93D);
    --gradient-brown: linear-gradient(135deg, var(--brown-mid), var(--brown-dark));
    --gradient-accent: linear-gradient(135deg, var(--accent), #FF8C42);
}
*{box-sizing:border-box}
html,body{height:100%}
body{
    margin:0;
    background: linear-gradient(180deg, #FFFCF5 0%, #FFF8E8 100%);
    font-family: "Inter", system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
    color:var(--brown-dark);
    padding-bottom:60px;
    background-image: 
        radial-gradient(circle at 20% 80%, rgba(255, 236, 139, 0.15) 0%, transparent 50%),
        radial-gradient(circle at 80% 20%, rgba(255, 193, 37, 0.1) 0%, transparent 50%);
}

/* HEADER EXPLOSIVO */
.header{
    position:sticky; top:0; z-index:30;
    background: linear-gradient(90deg, #FFD93D 0%, #FFC125 100%);
    padding:18px 20px;
    border-bottom: 4px solid var(--brown-dark);
    box-shadow: 0 8px 24px rgba(255, 193, 37, 0.4);
    display:flex; justify-content:space-between; align-items:center;
}
.brand{ display:flex; gap:12px; align-items:center;}
.logo{
    display:flex; gap:10px; align-items:center;
    background: linear-gradient(135deg, var(--brown-dark), #8B4513);
    padding:14px 18px; 
    border-radius: 16px; 
    color: white;
    font-family: "Baloo 2", cursive; 
    font-weight:800;
    font-size: 22px;
    box-shadow: var(--shadow-heavy);
    border: 3px solid var(--brand-yellow);
    text-shadow: 0 2px 4px rgba(0,0,0,0.2);
    transition: all 0.3s ease;
}
.logo:hover {
    transform: translateY(-3px);
    box-shadow: 0 12px 28px rgba(255, 193, 37, 0.4);
}
.logo img{ 
    height:42px; 
    display:block; 
    border-radius:8px;
    border: 2px solid var(--brand-yellow);
}
.tagline{ 
    font-size:14px; 
    color:#5D4037; 
    font-weight:600;
    background: rgba(255,255,255,0.9);
    padding: 6px 12px;
    border-radius: 20px;
    margin-top: 4px;
}

.contact{ display:flex; gap:10px; align-items:center }
.contact a{ 
    text-decoration:none; 
    color:var(--brown-dark); 
    background:rgba(255,255,255,0.9);
    padding:10px 14px; 
    border-radius:12px; 
    font-weight:600;
    font-size:14px;
    border: 2px solid var(--brown-dark);
    transition: all 0.2s ease;
    display: flex;
    align-items: center;
    gap: 6px;
}
.contact a:hover {
    background: var(--brown-dark);
    color: white;
    transform: translateY(-2px);
}

/* LAYOUT PRINCIPAL */
.wrap{ 
    max-width:1200px; 
    margin:24px auto; 
    padding:16px; 
    display:grid; 
    grid-template-columns:1fr 360px; 
    gap:24px; 
}
@media(max-width:980px){ 
    .wrap{ 
        grid-template-columns:1fr; 
        padding:12px;
        gap: 20px;
    } 
}

/* SE√á√ÉO COM PULS√ÉO */
.section{ 
    background: white; 
    border-radius:var(--card-radius); 
    padding:24px; 
    box-shadow:var(--shadow); 
    border-top: 8px solid var(--brand-yellow);
    border-left: 4px solid var(--brand-yellow-light);
    position: relative;
    overflow: hidden;
}
.section::before {
    content: '';
    position: absolute;
    top: 0;
    right: 0;
    width: 60px;
    height: 60px;
    background: var(--brand-yellow-light);
    border-radius: 0 0 0 100%;
    z-index: 0;
}
.section h2{ 
    margin:0 0 12px 0; 
    font-family:"Baloo 2", cursive; 
    color:var(--brown-dark);
    font-size: 28px;
    position: relative;
    z-index: 1;
}
.muted{ 
    color:#8B7355; 
    font-size:15px;
    font-weight: 500;
    padding: 8px 0;
}

/* GRID DE PRODUTOS ANIMADO */
.product-grid{ 
    display:grid; 
    grid-template-columns: repeat(auto-fill, minmax(260px,1fr)); 
    gap:18px; 
    margin-top:20px;
}

.product{ 
    border-radius:16px; 
    overflow:hidden; 
    background: linear-gradient(180deg,#fff,#FFFDF8); 
    border: 3px solid transparent;
    border-image: linear-gradient(135deg, var(--brand-yellow), var(--brown-light)) 1;
    display:flex; 
    flex-direction:column; 
    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    position: relative;
    box-shadow: 0 8px 20px rgba(139, 115, 85, 0.1);
}
.product:hover{ 
    transform:translateY(-8px);
    box-shadow: 0 16px 32px rgba(139, 115, 85, 0.2);
    border-color: var(--brand-yellow);
}
.product::after {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    height: 4px;
    background: var(--gradient-yellow);
}

.media{ 
    height:170px; 
    display:flex; 
    align-items:center; 
    justify-content:center; 
    background: linear-gradient(135deg, var(--brand-yellow-light), #FFE8A5);
    padding: 10px;
}
.media img{ 
    max-height:150px; 
    width:auto; 
    object-fit:cover; 
    border-radius:12px;
    box-shadow: 0 4px 12px rgba(0,0,0,0.1);
    border: 3px solid white;
}

.info{ 
    padding:18px; 
    display:flex; 
    flex-direction:column; 
    gap:12px;
    flex-grow: 1;
}
.title{ 
    font-weight:800; 
    color:var(--brown-dark);
    font-size: 18px;
    line-height: 1.3;
}
.desc{ 
    font-size:14px; 
    color:#A6896D;
    line-height: 1.4;
}

/* PRE√áO DESTACADO */
.price-row{ 
    display:flex; 
    justify-content:space-between; 
    align-items:center;
    margin-top: auto;
}
.price{ 
    font-weight:900; 
    color:var(--accent-hot); 
    font-size:22px;
    text-shadow: 0 2px 4px rgba(229, 113, 42, 0.15);
}
.old-price{ 
    text-decoration:line-through; 
    color:#B0896B; 
    font-size:14px;
    font-weight: 600;
}

/* CONTROLES VIBRANTES */
.controls{ 
    display:flex; 
    gap:10px; 
    align-items:center; 
    margin-top:8px;
}
.qty{ 
    display:flex; 
    align-items:center; 
    gap:8px; 
    background:#fff; 
    border-radius:12px; 
    padding:8px; 
    border: 2px solid var(--brand-yellow);
    box-shadow: 0 4px 8px rgba(255, 193, 37, 0.15);
}
.qty button{ 
    border:0; 
    background: linear-gradient(135deg, var(--brand-yellow), #FFD93D); 
    color:var(--brown-dark); 
    cursor:pointer; 
    width:36px; 
    height:36px;
    border-radius: 8px;
    font-weight: 900;
    font-size: 18px;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: all 0.2s ease;
}
.qty button:hover {
    background: var(--brown-dark);
    color: white;
}
.qty .val{ 
    min-width:36px; 
    text-align:center; 
    font-weight:800;
    font-size: 18px;
    color: var(--brown-dark);
}

/* BOT√ÉO PRINCIPAL - SUPER DESTACADO */
.btn{ 
    background: var(--gradient-brown); 
    color:white; 
    padding:12px 18px; 
    border-radius:12px; 
    border:0; 
    cursor:pointer; 
    font-weight:800; 
    font-size:15px;
    text-transform: uppercase;
    letter-spacing: 0.5px;
    box-shadow: 0 6px 16px rgba(155, 96, 59, 0.3);
    transition: all 0.3s ease;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 8px;
}
.btn:hover:not([disabled]) {
    transform: translateY(-3px);
    box-shadow: 0 10px 24px rgba(155, 96, 59, 0.4);
    background: linear-gradient(135deg, var(--brown-dark), #7A3E15);
}
.btn[disabled]{ 
    opacity:0.5; 
    cursor:not-allowed; 
    transform:none;
    background: #CCCCCC;
}

/* SABORES ESTILIZADOS */
.flavors{ 
    display:flex; 
    flex-wrap:wrap; 
    gap:8px; 
    margin-top:12px;
}
.flavor{ 
    background:#fff; 
    padding:8px 14px; 
    border-radius:20px; 
    border: 2px solid var(--brand-yellow-light);
    cursor:pointer; 
    font-size:13px;
    font-weight: 600;
    color: var(--brown-mid);
    transition: all 0.2s ease;
}
.flavor:hover {
    border-color: var(--brand-yellow);
    background: var(--brand-yellow-light);
}
.flavor.selected{ 
    background: var(--gradient-yellow); 
    color:var(--brown-dark); 
    font-weight:800;
    border-color: var(--brand-yellow);
    box-shadow: 0 4px 8px rgba(255, 193, 37, 0.3);
}

/* CARRINHO LATERAL DESTACADO */
.cart{ 
    position:sticky; 
    top:100px;
}
.box{ 
    background:white; 
    border-radius:var(--card-radius); 
    padding:24px; 
    box-shadow:var(--shadow); 
    border-top: 8px solid var(--accent);
    border-right: 4px solid var(--accent);
    position: relative;
}
.box::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    height: 6px;
    background: var(--gradient-accent);
}
.cart h3{ 
    margin:0 0 16px 0; 
    font-family:"Baloo 2", cursive; 
    color:var(--brown-dark);
    font-size: 24px;
}
.cart-items{ 
    max-height:380px; 
    overflow:auto; 
    margin-top:12px; 
    display:flex; 
    flex-direction:column; 
    gap:12px;
    padding-right: 8px;
}
.cart-item{ 
    display:flex; 
    justify-content:space-between; 
    gap:12px; 
    align-items:center; 
    border-bottom: 2px dashed rgba(155, 96, 59, 0.15); 
    padding-bottom:12px;
}
.cart-total{ 
    display:flex; 
    justify-content:space-between; 
    align-items:center; 
    margin-top:20px; 
    font-weight:900; 
    color:var(--brown-dark); 
    font-size:22px;
    padding-top: 16px;
    border-top: 3px solid var(--brand-yellow);
}

/* BOT√ïES DE CHECKOUT */
.checkout{ 
    margin-top:20px; 
    display:flex; 
    gap:12px;
}
.whatsapp-btn{ 
    background: linear-gradient(90deg,#25D366,#1DA851); 
    color:white; 
    padding:14px 18px; 
    border-radius:14px; 
    border:0; 
    cursor:pointer; 
    font-weight:800; 
    display:flex; 
    gap:10px; 
    align-items:center; 
    flex:1; 
    justify-content:center;
    font-size: 15px;
    box-shadow: 0 6px 16px rgba(37, 211, 102, 0.3);
    transition: all 0.3s ease;
}
.whatsapp-btn:hover {
    transform: translateY(-3px);
    box-shadow: 0 10px 24px rgba(37, 211, 102, 0.4);
}
.checkout-secondary{ 
    background: var(--gradient-yellow); 
    color:var(--brown-dark); 
    padding:14px 18px; 
    border-radius:14px; 
    font-weight:800; 
    border:0; 
    cursor:pointer; 
    flex:1;
    box-shadow: 0 6px 16px rgba(255, 193, 37, 0.3);
    transition: all 0.3s ease;
}
.checkout-secondary:hover {
    transform: translateY(-3px);
    box-shadow: 0 10px 24px rgba(255, 193, 37, 0.4);
}

/* PILLS DE INFORMA√á√ÉO ESTILIZADAS */
.info-grid{ 
    display:grid; 
    grid-template-columns: repeat(auto-fit,minmax(220px,1fr)); 
    gap:16px; 
    margin-top:16px;
}
.pill{ 
    background: linear-gradient(135deg, #FFFCF5, #FFF8E8);
    border-radius:14px; 
    padding:16px; 
    border: 3px solid var(--brand-yellow-light);
    box-shadow: 0 8px 16px rgba(255, 236, 139, 0.2);
}
.pill strong {
    color: var(--brown-dark);
    font-size: 16px;
    display: flex;
    align-items: center;
    gap: 8px;
    margin-bottom: 8px;
}

/* MODAL MODERNO */
.modal{ 
    display:none; 
    position:fixed; 
    inset:0; 
    background:rgba(91,34,15,0.8); 
    z-index:60; 
    align-items:center; 
    justify-content:center; 
    padding:18px;
    backdrop-filter: blur(6px);
}
.modal .card{ 
    width:100%; 
    max-width:620px; 
    border-radius:20px; 
    padding:28px; 
    background: white;
    box-shadow: 0 24px 48px rgba(0,0,0,0.2);
    border: 4px solid var(--brand-yellow);
    animation: modalSlideIn 0.4s ease;
}

@keyframes modalSlideIn {
    from { opacity: 0; transform: translateY(-40px); }
    to { opacity: 1; transform: translateY(0); }
}

/* CHIPS DE SABORES NO MODAL */
.chips{ 
    display:flex; 
    flex-wrap:wrap; 
    gap:10px; 
    margin-top:16px;
}
.chip{ 
    padding:12px 18px; 
    border-radius:999px; 
    border: 2px solid var(--brand-yellow);
    cursor:pointer; 
    background:#fff;
    font-weight: 600;
    color: var(--brown-mid);
    transition: all 0.2s ease;
}
.chip:hover {
    background: var(--brand-yellow-light);
}
.chip.selected{ 
    background: var(--gradient-yellow); 
    color:var(--brown-dark); 
    font-weight:800;
    border-color: var(--brand-yellow-dark);
    box-shadow: 0 6px 12px rgba(255, 193, 37, 0.3);
}

/* BADGE DE PROMO√á√ÉO EXPLOSIVO */
.promo-badge{ 
    background: var(--gradient-accent); 
    color:white; 
    font-weight:900; 
    padding:6px 12px; 
    border-radius:10px; 
    font-size:13px;
    text-transform: uppercase;
    letter-spacing: 0.5px;
    display: inline-block;
    margin-left: 10px;
    box-shadow: 0 4px 8px rgba(229, 113, 42, 0.3);
}
.empty{ 
    text-align:center; 
    color:#bda08a; 
    padding:40px 12px;
    font-size: 16px;
}

/* RODAP√â ESTILIZADO */
footer {
    text-align:center;
    color:#8B7355;
    padding:24px 12px;
    background: linear-gradient(90deg, #FFF8E8, #FFE8A5);
    margin-top: 40px;
    border-top: 4px solid var(--brand-yellow);
    font-weight: 600;
}

/* SCROLLBAR PERSONALIZADA */
::-webkit-scrollbar {
    width: 10px;
}
::-webkit-scrollbar-track {
    background: #FFF8E8;
    border-radius: 10px;
}
::-webkit-scrollbar-thumb {
    background: var(--brand-yellow);
    border-radius: 10px;
    border: 2px solid #FFF8E8;
}
::-webkit-scrollbar-thumb:hover {
    background: var(--brand-yellow-dark);
}
</style>
</head>
<body>

<header class="header">
    <div class="brand">
        <div class="logo">
            <div style="display:flex;align-items:center;gap:12px;">
                <span style="font-size:28px">üéâ</span>
                <div style="display:flex;flex-direction:column;line-height:1.2;">
                    <div>Doce Confete</div>
                    <div class="tagline">doces & salgados com amor!</div>
                </div>
            </div>
        </div>
    </div>

    <div class="contact">
        <a href="tel:558791060340">üìû (87) 9106-0340</a>
        <a href="https://wa.me/558791060340" target="_blank">üí¨ WhatsApp</a>
    </div>
</header>

<main class="wrap">
    <div>
        <div class="section">
            <h2>üçï Salgados</h2>
            <div class="muted">Escolha o produto ‚Äî depois escolha sabores ao adicionar</div>
            <div id="salgados" class="product-grid"></div>
        </div>

        <div class="section" style="margin-top:24px;">
            <h2>üç¨ Doces</h2>
            <div class="muted">Ao clicar em "Adicionar" escolha os sabores</div>
            <div id="doces" class="product-grid"></div>
        </div>

        <div class="section" style="margin-top:24px;">
            <h2>üéÅ Kits e Combos</h2>
            <div class="muted">Kits para festas ‚Äî escolha e adicione</div>
            <div id="combos" class="product-grid"></div>
        </div>

        <div class="section" style="margin-top:24px;">
            <h2>üç© Mini Churros</h2>
            <div id="churros" class="product-grid"></div>
        </div>

        <div class="section" style="margin-top:24px;">
            <h2>‚ÑπÔ∏è Informa√ß√µes importantes</h2>
            <div class="info-grid">
                <div class="pill">
                    <strong>‚è∞ Hor√°rio</strong>
                    <p style="margin:8px 0 0 0; font-size:14px; color:#6b4a3b">
                        Trabalhamos de domingo a domingo.<br>
                        Segunda a s√°bado:<br>
                        ‚Ä¢ 10:00 ‚Äì 12:00 (manh√£: retirada/entrega de encomendas)<br>
                        ‚Ä¢ 14:00 ‚Äì 18:00 (aberto ao p√∫blico)<br>
                        Domingo: 08:00 ‚Äì 10:00
                    </p>
                </div>

                <div class="pill">
                    <strong>üöö Entrega</strong>
                    <p style="margin:8px 0 0 0; font-size:14px; color:#6b4a3b">
                        A entrega depende do bairro/regi√£o de Caruaru ‚Äî o valor ser√° informado no chat.
                    </p>
                </div>

                <div class="pill">
                    <strong>üí≥ Pagamento</strong>
                    <p style="margin:8px 0 0 0; font-size:14px; color:#6b4a3b">
                        PIX, Cart√£o e Dinheiro.
                    </p>
                </div>
            </div>
        </div>
    </div>

    <aside class="cart">
        <div class="box">
            <h3>üõí Seu Pedido</h3>
            <div id="cart-items" class="cart-items">
                <div class="empty">Seu carrinho est√° vazio. Adicione algo gostoso! üòã</div>
            </div>

            <div class="cart-total" id="cart-total">Total: R$ 0,00</div>

            <div class="checkout">
                <button id="open-checkout" class="checkout-secondary">Finalizar</button>
                <button id="whatsapp-quick" class="whatsapp-btn">üí¨ Enviar WhatsApp</button>
            </div>

            <div style="margin-top:16px; font-size:14px; color:#7a5a4a; background: #FFF8E8; padding: 12px; border-radius: 10px;">
                <strong>üìù Observa√ß√µes:</strong>
                <p style="margin:6px 0 0 0">Endere√ßo e agendamento s√£o solicitados na finaliza√ß√£o.</p>
            </div>
        </div>
    </aside>
</main>

<footer>¬© Doce Confete ‚Äî (87) 9106-0340 ‚Ä¢ Instagram: doc_confete</footer>

<!-- MODAL GERAL -->
<div id="modal" class="modal" aria-hidden="true">
    <div class="card">
        <!-- content trocado dinamicamente -->
        <div id="modal-body"></div>
    </div>
</div>

<script>
/* ====== Ajuste a baseImage se as imagens estiverem em outro lugar ====== */
const baseImage = 'https://doc-confete.github.io/cardapio-loja/'; // ou '' se usar paths relativos

/* === dados === */
const produtosData = [
  {id:'p25',nome:'25 Salgados',preco:20.00, img:'images/25-salgados.jpg', categoria:'salgado'},
  {id:'p50',nome:'50 Salgados (Meio Cento)',preco:30.00, img:'images/50-salgados.jpg', categoria:'salgado'},
  {id:'p100',nome:'100 Salgados (Cento)',preco:50.00, precoOriginal:60.00, img:'images/100-salgados.jpg', categoria:'salgado', promo:true}
];

const docesData = [
  {id:'d40',nome:'40 Doces',preco:40.00,img:'images/40-doces.jpg', categoria:'doce'},
  {id:'d50',nome:'50 Doces',preco:50.00,img:'images/50-doces.jpg', categoria:'doce'},
  {id:'d100',nome:'100 Doces',preco:100.00,img:'images/100-doces.jpg', categoria:'doce'}
];

const combosData = [
  { id:'combo_fome', nome:'T√¥ com Fome', preco:19.00, img:'images/combo_fome.jpg', desc:'20 salgados + 10 mini churros' },
  { id:'combo_delicia', nome:'Del√≠cia da Casa', preco:35.00, img:'images/combo_delicia.jpg', desc:'40 salgados + 10 mini churros' },
  { id:'combo_festa', nome:'Festa Total', preco:55.00, img:'images/combo_festa.jpg', desc:'100 salgados + 10 mini churros' }
];

/* kits pedidos: 5,10,20,40 e kit lanche */
const kitsData = [
  { id:'kit_5', nome:'Kit 5 pessoas', preco:70.00, img:'images/5-pessoas.jpg', desc:'50 salgados + 40 doces' },
  { id:'kit_10_15', nome:'Kit 10‚Äì15 pessoas', preco:100.00, img:'images/10-pessoas.jpg', desc:'100 salgados + 50 doces' },
  { id:'kit_20', nome:'Kit 20 pessoas', preco:180.00, img:'images/20-pessoas.jpg', desc:'200 salgados + 80 docinhos' },
  { id:'kit_40', nome:'Kit 40 pessoas', preco:360.00, img:'images/40-pessoas.jpg', desc:'400 salgados + 160 docinhos' },
  { id:'kit_lanche', nome:'Kit Lanche', preco:45.00, img:'images/kit-lanche.jpg', desc:'50 salgados + 15 docinhos' }
];

const miniChurrosData = [
  {id:'c10', nome:'Por√ß√£o 10 Mini Churros', preco:9.99, img:'images/mini-churros-10.jpg'},
  {id:'c50', nome:'Por√ß√£o 50 Mini Churros', preco:29.00, img:'images/mini-churros-50.jpg'},
  {id:'c100', nome:'Por√ß√£o 100 Mini Churros', preco:50.90, img:'images/mini-churros-100.jpg'},
  {id:'kit2', nome:'Kit 2 Churros Gourmet', preco:9.00, img:'images/kit-churros-2.jpg'}
];

const saboresSalgado = [ 'Coxinha','Medalh√£o de Salsicha','Pastel de Carne com A√ß√∫car','Pastel de Carne','Bolinha de Queijo','Bal√£o de Pizza','Travesseiro de Carne' ];
const saboresDoce = [ 'Ferrero Rocher','Prest√≠gio','Beijinho','Casadinho','Churros','Brigadeiro','Ninho' ];

/* === estado === */
let cart = [];
const CART_KEY = 'doce_confete_cart_v2';

/* ==== helpers ==== */
function formatPrice(v){ return v.toLocaleString('pt-BR',{ style:'currency', currency:'BRL' }) }
function saveCart(){ localStorage.setItem(CART_KEY, JSON.stringify(cart)) }
function loadCart(){ const s = localStorage.getItem(CART_KEY); if(s) cart = JSON.parse(s) }

/* === criar cards === */
function createProductCard(item, flavorsList = []) {
    const card = document.createElement('div');
    card.className = 'product';
    card.innerHTML = `
        <div class="media">
            <div style="font-size: 60px; color: var(--brown-dark); opacity: 0.9;">ü•ü</div>
        </div>
        <div class="info">
            <div class="title">${item.nome} ${item.promo ? '<span class="promo-badge">üî• PROMO√á√ÉO</span>' : ''}</div>
            <div class="desc">${item.desc ? item.desc : ''}</div>

            <div style="display:flex; justify-content:space-between; align-items:center;">
                <div>
                    <div class="price">${formatPrice(item.preco)}</div>
                    ${item.precoOriginal ? `<div class="old-price">${formatPrice(item.precoOriginal)}</div>` : ''}
                </div>
                <div style="min-width:160px;">
                    <div class="controls">
                        <div class="qty">
                            <button class="minus" aria-label="diminuir">-</button>
                            <div class="val">0</div>
                            <button class="plus" aria-label="aumentar">+</button>
                        </div>
                        <button class="btn add" disabled>
                            <span>üõí</span> Adicionar
                        </button>
                    </div>
                </div>
            </div>

            ${flavorsList.length ? `<div class="muted" style="margin-top:12px;font-size:14px; background: #FFF8E8; padding: 8px 12px; border-radius: 8px;">üéØ Sabores: ser√£o escolhidos ao adicionar</div>` : ''}
        </div>
    `;

    const minus = card.querySelector('.minus');
    const plus = card.querySelector('.plus');
    const val = card.querySelector('.val');
    const addBtn = card.querySelector('.add');

    function updateAddState(){
        const v = parseInt(val.textContent);
        addBtn.disabled = v <= 0;
    }

    minus.addEventListener('click', ()=> {
        let v = parseInt(val.textContent);
        if(v > 0) v--;
        val.textContent = v;
        updateAddState();
    });
    plus.addEventListener('click', ()=> {
        let v = parseInt(val.textContent);
        if(v < 100) v++;
        val.textContent = v;
        updateAddState();
    });

    addBtn.addEventListener('click', ()=> {
        const qty = parseInt(val.textContent);
        if(qty <= 0) return;
        // se o item tem sabores, abrir modal de sele√ß√£o de sabores antes de adicionar
        if(flavorsList.length) {
            openFlavorModal(item, qty, flavorsList);
        } else {
            // adicionar direto (kits/churros)
            doAddToCart(item, qty, []);
        }
        // reset qty visual para 0
        val.textContent = '0';
        updateAddState();
    });

    return card;
}

/* montar grids */
function mountGrid(containerId, data, flavors){
    const cont = document.getElementById(containerId);
    cont.innerHTML = '';
    data.forEach(d => cont.appendChild(createProductCard(d, flavors)));
}

/* adicionar ao carrinho (interno) */
function doAddToCart(item, qty, flavors){
    const key = `${item.id}__${flavors.join('|')}`;
    const idx = cart.findIndex(ci => ci.key === key);
    if(idx > -1){
        cart[idx].quantity += qty;
    } else {
        cart.push({
            key,
            id: item.id,
            name: item.nome,
            price: item.preco,
            quantity: qty,
            flavors: flavors
        });
    }
    saveCart();
    renderCart();
    toast('‚úÖ Adicionado ao carrinho!');
}

/* render cart */
function renderCart(){
    const el = document.getElementById('cart-items');
    if(!cart.length){
        el.innerHTML = `<div class="empty">
            <div style="font-size: 48px; margin-bottom: 12px; opacity: 0.5;">üõí</div>
            <p style="font-weight: 600; color: var(--brown-mid);">Seu carrinho est√° vazio</p>
            <p style="font-size: 14px; color: #A6896D;">Adicione algo gostoso! üòã</p>
        </div>`;
        document.getElementById('cart-total').textContent = 'Total: R$ 0,00';
        return;
    }
    el.innerHTML = '';
    let total = 0;
    cart.forEach((it, idx) => {
        const itemTotal = it.price * it.quantity; total += itemTotal;
        const node = document.createElement('div');
        node.className = 'cart-item';
        node.innerHTML = `
            <div>
                <div style="font-weight:800; color: var(--brown-dark)">${it.name} <span style="color:var(--accent);font-weight:800">x${it.quantity}</span></div>
                ${it.flavors && it.flavors.length ? `<div style="font-size:13px;color:#8B7355; background: #FFF8E8; padding: 4px 8px; border-radius: 6px; margin-top: 4px;">Sabores: ${it.flavors.join(', ')}</div>` : `<div style="font-size:13px;color:#8B7355;">Sem sabores selecionados</div>`}
            </div>
            <div style="text-align:right">
                <div style="font-weight:900;color:var(--accent-hot); font-size: 16px;">${formatPrice(itemTotal)}</div>
                <div style="display:flex;gap:6px;margin-top:8px;justify-content:flex-end">
                    <button data-idx="${idx}" class="btn btn-light dec" style="background: var(--brand-yellow-light); color: var(--brown-dark); padding: 6px 10px; border-radius: 8px; border: none; font-weight: 800;">-</button>
                    <button data-idx="${idx}" class="btn btn-light inc" style="background: var(--brand-yellow-light); color: var(--brown-dark); padding: 6px 10px; border-radius: 8px; border: none; font-weight: 800;">+</button>
                    <button data-idx="${idx}" class="btn btn-light rem" style="background: #FFE8E8; color: #E74C3C; padding: 6px 10px; border-radius: 8px; border: none; font-weight: 800;">Remover</button>
                </div>
            </div>
        `;
        el.appendChild(node);
    });
    document.getElementById('cart-total').textContent = `Total: ${formatPrice(total)}`;

    // handlers
    el.querySelectorAll('.dec').forEach(b => b.addEventListener('click', e=>{
        const i = parseInt(e.currentTarget.dataset.idx);
        if(cart[i].quantity > 1) cart[i].quantity--;
        else cart.splice(i,1);
        saveCart(); renderCart();
    }));
    el.querySelectorAll('.inc').forEach(b => b.addEventListener('click', e=>{
        const i = parseInt(e.currentTarget.dataset.idx);
        cart[i].quantity++; saveCart(); renderCart();
    }));
    el.querySelectorAll('.rem').forEach(b => b.addEventListener('click', e=>{
        const i = parseInt(e.currentTarget.dataset.idx);
        cart.splice(i,1); saveCart(); renderCart();
    }));
}

/* toast com estilo novo */
function toast(msg){
    const el = document.createElement('div');
    el.textContent = msg;
    el.style.cssText = `
        position: fixed; 
        right: 20px; 
        bottom: 20px; 
        padding: 14px 20px; 
        background: linear-gradient(135deg, var(--brand-yellow), #FFD93D);
        color: var(--brown-dark); 
        border-radius: 12px; 
        font-weight: 800; 
        box-shadow: 0 8px 24px rgba(255, 193, 37, 0.4);
        z-index: 9999;
        border: 3px solid white;
        animation: toastSlideIn 0.3s ease;
    `;
    document.body.appendChild(el);
    setTimeout(()=> {
        el.style.animation = 'toastSlideOut 0.3s ease forwards';
        setTimeout(()=> el.remove(), 300);
    }, 2200);
}

// Adicionar anima√ß√µes do toast
const style = document.createElement('style');
style.textContent = `
    @keyframes toastSlideIn {
        from { transform: translateX(100px); opacity: 0; }
        to { transform: translateX(0); opacity: 1; }
    }
    @keyframes toastSlideOut {
        from { transform: translateX(0); opacity: 1; }
        to { transform: translateX(100px); opacity: 0; }
    }
`;
document.head.appendChild(style);

/* ===== Flavor modal (quando o produto tem sabores) ===== */
let pendingFlavor = null; // {item, qty, flavorsList}
function openFlavorModal(item, qty, flavorsList){
    pendingFlavor = { item, qty, flavorsList };
    const modal = document.getElementById('modal');
    const body = document.getElementById('modal-body');
    body.innerHTML = `
        <div style="display: flex; align-items: center; gap: 12px; margin-bottom: 16px;">
            <div style="background: var(--gradient-yellow); width: 50px; height: 50px; border-radius: 12px; display: flex; align-items: center; justify-content: center; font-size: 24px;">ü•ü</div>
            <div>
                <h3 style="margin:0; color: var(--brown-dark)">Escolha os sabores</h3>
                <p style="margin:4px 0 0 0; color: var(--brown-mid); font-size: 15px;">${item.nome} ‚Ä¢ ${qty} unidade(s)</p>
            </div>
        </div>
        
        <p style="margin-top:6px;color:#6b4a3b; background: #FFF8E8; padding: 12px; border-radius: 10px;">üéØ Selecione os sabores desejados (toque para marcar). Voc√™ pode escolher at√© ${qty} sabores por item.</p>
        <div class="chips" id="flavor-chips">
            ${flavorsList.map(f => `<div class="chip" data-flavor="${f}">${f}</div>`).join('')}
        </div>

        <div style="display:flex; gap:10px; margin-top:24px; align-items:center;">
            <div style="font-size:15px; color: var(--brown-dark); font-weight: 600;">Quantidade: <span style="color: var(--accent); font-size: 18px;">${qty}</span></div>
            <div style="flex:1"></div>
            <button id="cancel-flavors" class="btn" style="background: #CCCCCC; color: #666;">Cancelar</button>
            <button id="confirm-flavors" class="btn" style="background: var(--gradient-brown);">‚úÖ Confirmar</button>
        </div>
    `;
    // attach events
    modal.style.display = 'flex'; modal.setAttribute('aria-hidden','false');
    const chips = Array.from(document.querySelectorAll('#flavor-chips .chip'));
    chips.forEach(c => c.addEventListener('click', ()=> c.classList.toggle('selected')));

    document.getElementById('cancel-flavors').onclick = ()=> { modal.style.display='none'; pendingFlavor = null; };
    document.getElementById('confirm-flavors').onclick = ()=> {
        const selected = Array.from(document.querySelectorAll('#flavor-chips .chip.selected')).map(n => n.dataset.flavor);
        // if user didn't select nenhum, aceita vazio tamb√©m
        doAddToCart(item, qty, selected);
        modal.style.display='none'; pendingFlavor = null;
    };
}

/* ====== checkout modal (finalizar pedido) ====== */
function openCheckoutModal(){
    if(!cart.length){ toast('üéØ Adicione algo ao carrinho antes de finalizar'); return; }
    const modal = document.getElementById('modal');
    const body = document.getElementById('modal-body');
    body.innerHTML = `
        <h3 style="margin:0 0 16px 0; color: var(--brown-dark); display: flex; align-items: center; gap: 10px;">üìã Finalizar Pedido</h3>
        
        <div style="background: #FFF8E8; padding: 16px; border-radius: 12px; margin-bottom: 20px;">
            <div style="display: flex; justify-content: space-between; align-items: center;">
                <div style="font-weight: 600; color: var(--brown-dark);">Itens no carrinho:</div>
                <div style="font-weight: 800; color: var(--accent-hot); font-size: 18px;">${formatPrice(cart.reduce((s,i)=> s + i.price*i.quantity, 0))}</div>
            </div>
        </div>
        
        <div style="display:grid; gap:16px;">
            <label style="display: block;">
                <div style="font-weight:700; margin-bottom:8px; color: var(--brown-dark);">Nome do cliente *</div>
                <input id="client-name" style="width:100%; padding:14px; border-radius:10px; border:2px solid var(--brand-yellow); font-size:16px;" placeholder="Seu nome completo">
            </label>
            
            <label style="display: block;">
                <div style="font-weight:700; margin-bottom:8px; color: var(--brown-dark);">Retirada ou Entrega?</div>
                <div style="display:flex; gap:10px;">
                    <button class="btn" data-type="retirada" style="background: var(--gradient-yellow); color: var(--brown-dark); flex:1;">üè† Retirada</button>
                    <button class="btn" data-type="entrega" style="background: var(--brand-yellow-light); color: var(--brown-dark); flex:1;">üöö Entrega</button>
                </div>
            </label>
            
            <div id="address-block" style="display:none;">
                <label style="display: block;">
                    <div style="font-weight:700; margin-bottom:8px; color: var(--brown-dark);">Endere√ßo de entrega *</div>
                    <textarea id="client-address" style="width:100%; padding:14px; border-radius:10px; border:2px solid var(--brand-yellow);" rows="3" placeholder="Rua, n√∫mero, bairro, ponto de refer√™ncia"></textarea>
                </label>
            </div>
            
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 16px;">
                <label style="display: block;">
                    <div style="font-weight:700; margin-bottom:8px; color: var(--brown-dark);">Forma de pagamento</div>
                    <select id="payment" style="width:100%; padding:14px; border-radius:10px; border:2px solid var(--brand-yellow); font-size:15px;">
                        <option value="PIX">PIX (5% OFF)</option>
                        <option value="Cart√£o">Cart√£o</option>
                        <option value="Dinheiro">Dinheiro</option>
                    </select>
                </label>
                
                <label style="display: block;">
                    <div style="font-weight:700; margin-bottom:8px; color: var(--brown-dark);">Agendamento (opcional)</div>
                    <input id="agendamento" type="text" placeholder="Ex: 20/02 ‚Äî 14:30" style="width:100%; padding:14px; border-radius:10px; border:2px solid var(--brand-yellow);">
                </label>
            </div>
            
            <label style="display: block;">
                <div style="font-weight:700; margin-bottom:8px; color: var(--brown-dark);">Observa√ß√µes (opcional)</div>
                <textarea id="notes" style="width:100%; padding:14px; border-radius:10px; border:2px solid var(--brand-yellow);" rows="2" placeholder="Alguma observa√ß√£o especial?"></textarea>
            </label>
            
            <div style="display:flex; gap:12px; margin-top:24px;">
                <button id="cancel-modal" class="btn" style="background: #E0E0E0; color: #666; flex:1;">Cancelar</button>
                <button id="send-order" class="btn" style="background: var(--gradient-brown); flex:2;">üì§ Enviar pedido pelo WhatsApp</button>
            </div>
        </div>
    `;
    modal.style.display='flex'; modal.setAttribute('aria-hidden','false');

    // entrega/retirada btns
    document.querySelectorAll('[data-type]').forEach(btn=>{
        btn.addEventListener('click', (e)=>{
            document.querySelectorAll('[data-type]').forEach(b=>{
                b.style.background = 'var(--brand-yellow-light)';
            });
            e.currentTarget.style.background = 'var(--gradient-yellow)';
            const t = e.currentTarget.dataset.type;
            document.getElementById('modal').dataset.type = t;
            document.getElementById('address-block').style.display = t === 'entrega' ? 'block' : 'none';
        });
    });

    document.getElementById('cancel-modal').onclick = ()=> { modal.style.display='none'; };
    document.getElementById('send-order').onclick = sendOrderWhatsApp;
}

/* build whatsapp message (sem desconto PIX) */
function generateOrderNumber(){
    const d = new Date();
    const ts = d.getFullYear().toString().slice(2) +
               String(d.getMonth()+1).padStart(2,'0') +
               String(d.getDate()).padStart(2,'0') +
               String(d.getHours()).padStart(2,'0') +
               String(d.getMinutes()).padStart(2,'0') +
               String(d.getSeconds()).padStart(2,'0');
    return 'DC-' + ts;
}

function buildWhatsAppMessage(data){
    const orderId = generateOrderNumber();
    let total = cart.reduce((s,i)=> s + i.price*i.quantity, 0);

    let message = `üéâ *PEDIDO - DOCE CONFETE*\n`;
    message += `üìã *Pedido n¬∫:* ${orderId}\n\n`;
    message += `üë§ *Cliente:* ${data.name}\n`;
    if(data.phone) message += `üìû *Telefone:* ${data.phone}\n`;
    message += `\nüì¶ *ITENS DO PEDIDO:*\n`;

    cart.forEach(it => {
        message += `\n‚Ä¢ *${it.name}* - ${formatPrice(it.price)}\n`;
        message += `  ${it.quantity}x = ${formatPrice(it.price * it.quantity)}\n`;
        if(it.flavors && it.flavors.length) message += `  üéØ *Sabores:* ${it.flavors.join(', ')}\n`;
    });

    message += `\nüí∞ *TOTAL:* ${formatPrice(total)}`;
    message += `\n\nüìç *Endere√ßo:* ${data.type === 'entrega' ? (data.address || '---') : 'Retirada no local'}`;
    if(data.schedule) message += `\n‚è∞ *Agendamento:* ${data.schedule}`;
    message += `\nüí≥ *Pagamento:* ${data.payment}`;
    if(data.notes) message += `\n\nüìù *Observa√ß√µes:* ${data.notes}`;

    message += `\n\n${data.type === 'entrega' ? 'üöö *PEDIDO PARA ENTREGA*' : 'üè† *PEDIDO PARA RETIRADA*'}`;

    return encodeURIComponent(message);
}

/* enviar pedido via whatsapp */
function sendOrderWhatsApp(){
    const name = document.getElementById('client-name').value.trim();
    const phone = document.getElementById('client-phone') ? document.getElementById('client-phone').value.trim() : '';
    const type = document.getElementById('modal').dataset.type || 'retirada';
    const address = document.getElementById('client-address') ? document.getElementById('client-address').value.trim() : '';
    const schedule = document.getElementById('agendamento').value.trim();
    const payment = document.getElementById('payment').value;
    const notes = document.getElementById('notes').value.trim();

    if(!name){ toast('‚ùå Digite o nome do cliente'); document.getElementById('client-name').focus(); return; }
    if(type === 'entrega' && !address){ toast('‚ùå Digite o endere√ßo para entrega'); document.getElementById('client-address').focus(); return; }

    const data = { name, phone, type, address, schedule, payment, notes };
    const msg = buildWhatsAppMessage(data);

    const phoneTo = '558791060340';
    const url = `https://wa.me/${phoneTo}?text=${msg}`;
    window.open(url, '_blank');

    // limpa tudo
    cart = []; saveCart(); renderCart();
    document.getElementById('modal').style.display = 'none';
    document.getElementById('client-name').value = '';
    if(document.getElementById('client-address')) document.getElementById('client-address').value = '';
    document.getElementById('agendamento').value = '';
    document.getElementById('notes').value = '';
    toast('üéâ Pedido enviado! Obrigado! ‚ù§Ô∏è');
}

/* quick open modal */
document.addEventListener('DOMContentLoaded', ()=> {
    mountGrid('salgados', produtosData, saboresSalgado);
    mountGrid('doces', docesData, saboresDoce);
    mountGrid('combos', combosData.concat(kitsData), []); // combos + kits (kits sem sabores)
    mountGrid('churros', miniChurrosData, []);

    loadCart(); renderCart();

    document.getElementById('open-checkout').addEventListener('click', openCheckoutModal);
    document.getElementById('whatsapp-quick').addEventListener('click', ()=> {
        if(!cart.length){ toast('üéØ Seu carrinho est√° vazio'); return; }
        openCheckoutModal();
    });

    // fechar modal clicando fora
    document.getElementById('modal').addEventListener('click', (e)=>{
        if(e.target === e.currentTarget) e.currentTarget.style.display = 'none';
    });
});
</script>

</body>
</html>
